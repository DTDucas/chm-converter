

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
MechanicalUtils..::..ConnectDuctPlaceholdersAtElbow Method (Document, Connector, Connector)  
[MechanicalUtils Class](f7cbd23a-1b69-d9bf-88b4-df10a8c4be0b.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Connects a pair of placeholders that can intersect in an Elbow connection. 

**Namespace:** [Autodesk.Revit.DB.Mechanical](0eafd899-5912-56fd-94b1-d286156e26fc.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2012 

# Syntax

C#  
---  
      
    
    public static bool ConnectDuctPlaceholdersAtElbow(
    	[Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md) document,
    	[Connector](11e07082-b3f2-26a1-de79-16535f44716c.md) connector1,
    	[Connector](11e07082-b3f2-26a1-de79-16535f44716c.md) connector2
    )  
  
Visual Basic  
---  
      
    
    Public Shared Function ConnectDuctPlaceholdersAtElbow ( _
    	document As [Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md), _
    	connector1 As [Connector](11e07082-b3f2-26a1-de79-16535f44716c.md), _
    	connector2 As [Connector](11e07082-b3f2-26a1-de79-16535f44716c.md) _
    ) As Boolean  
  
Visual C++  
---  
      
    
    public:
    static bool ConnectDuctPlaceholdersAtElbow(
    	[Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md)^ document, 
    	[Connector](11e07082-b3f2-26a1-de79-16535f44716c.md)^ connector1, 
    	[Connector](11e07082-b3f2-26a1-de79-16535f44716c.md)^ connector2
    )  
  
#### Parameters

document
    Type: [Autodesk.Revit.DB..::..Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md) The document. 

connector1
    Type: [Autodesk.Revit.DB..::..Connector](11e07082-b3f2-26a1-de79-16535f44716c.md) The end connector of the first placeholder. 

connector2
    Type: [Autodesk.Revit.DB..::..Connector](11e07082-b3f2-26a1-de79-16535f44716c.md) The end connector of the second placeholder. 

#### Return Value

True if connection succeeds, false otherwise. 

# Remarks

The placeholders may have a physical intersection but this is not required. If they are not intersecting the connectors must be coplanar and able to be moved to intersect each other. If connection fails, the placeholders cannot be physically connected. 

# Examples

CopyC#
    
    
    //Create a point to be the connection point of two ductPlaceholders
    XYZ connectionPoint = new XYZ(150, 0, 0);
    
    //Create two new ductPlaceholders, duct1 and duct2, each ductPlaceholder has connectionPoint as its parameter
    Duct duct1 = Duct.CreatePlaceholder(document, systemTypeId, ductTypeId, levelId, new XYZ(100, 0, 0), connectionPoint);
    Duct duct2 = Duct.CreatePlaceholder(document, systemTypeId, ductTypeId, levelId, connectionPoint, new XYZ(150, 50, 0));
    
    //Get Connectors of duct1 and duct2's ConnectorManager and change their type to IEnumerable<Connector>
    //Get the first connector from the IEnumerable where the origin of the connector is almost equal to connectionPoint
    Connector connector1 = duct1.ConnectorManager.Connectors.Cast<Connector>().Where(c => c.Origin.IsAlmostEqualTo(connectionPoint)).First();
    Connector connector2 = duct2.ConnectorManager.Connectors.Cast<Connector>().Where(c => c.Origin.IsAlmostEqualTo(connectionPoint)).First();
    
    //Connect duct1 and duct2 with elbow fitting by their intersecting connectors(whose origin is almost equal to connectionPoint)
    bool connectResult = MechanicalUtils.ConnectDuctPlaceholdersAtElbow(document, connector1, connector2);
    
    //Convert duct1 and duct2 to real ducts
    ICollection<ElementId> convertedElementsId = MechanicalUtils.ConvertDuctPlaceholders(document, new ElementId[] { duct1.Id, duct2.Id });

CopyVB.NET
    
    
    'Create a point to be the connection point of two ductPlaceholders
    Dim connectionPoint As New XYZ(150, 0, 0)
    
    'Create two new ductPlaceholders, duct1 and duct2, each ductPlaceholder has connectionPoint as its parameter
    Dim duct1 As Duct = Duct.CreatePlaceholder(document, systemTypeId, ductTypeId, levelId, New XYZ(100, 0, 0), connectionPoint)
    Dim duct2 As Duct = Duct.CreatePlaceholder(document, systemTypeId, ductTypeId, levelId, connectionPoint, New XYZ(150, 50, 0))
    
    'Get Connectors of duct1 and duct2's ConnectorManager and change their type to IEnumerable<Connector>
    'Get the first connector from the IEnumerable where the origin of the connector is almost equal to connectionPoint
    Dim connector1 As Connector = duct1.ConnectorManager.Connectors.Cast(Of Connector)().Where(Function(c) c.Origin.IsAlmostEqualTo(connectionPoint)).First()
    Dim connector2 As Connector = duct2.ConnectorManager.Connectors.Cast(Of Connector)().Where(Function(c) c.Origin.IsAlmostEqualTo(connectionPoint)).First()
    
    'Connect duct1 and duct2 with elbow fitting by their intersecting connectors(whose origin is almost equal to connectionPoint)
    Dim connectResult As Boolean = MechanicalUtils.ConnectDuctPlaceholdersAtElbow(document, connector1, connector2)
    
    'Convert duct1 and duct2 to real ducts
    Dim convertedElementsId As ICollection(Of ElementId) = MechanicalUtils.ConvertDuctPlaceholders(document, New ElementId() {duct1.Id, duct2.Id})

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentException](2e6e4206-97a8-dd4b-df5d-4269f4bb6088.md) | The owner of connector is not duct placeholder. -or- The owners of connectors belong to different types of system. |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | A non-optional argument was null |
  
# See Also

[MechanicalUtils Class](f7cbd23a-1b69-d9bf-88b4-df10a8c4be0b.md)

[ConnectDuctPlaceholdersAtElbow Overload](7b82eb6f-4daf-cc0b-0ae6-9468c95a7245.md)

[Autodesk.Revit.DB.Mechanical Namespace](0eafd899-5912-56fd-94b1-d286156e26fc.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)