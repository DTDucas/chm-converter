

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
ViewSheet..::..SetAdditionalRevisionIds Method   
[ViewSheet Class](af2ee879-173d-df3a-9793-8d5750a17b49.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Sets the Revisions to additionally include in the sheet's revision schedules. 

**Namespace:** [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2015 

# Syntax

C#  
---  
      
    
    public void SetAdditionalRevisionIds(
    	ICollection<[ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md)> projectRevisionIds
    )  
  
Visual Basic  
---  
      
    
    Public Sub SetAdditionalRevisionIds ( _
    	projectRevisionIds As ICollection(Of [ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md)) _
    )  
  
Visual C++  
---  
      
    
    public:
    void SetAdditionalRevisionIds(
    	ICollection<[ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md)^>^ projectRevisionIds
    )  
  
#### Parameters

projectRevisionIds
    Type: System.Collections.Generic..::..ICollection<(Of <(<'[ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md)>)>)> The ids of Revisions to explicitly include in the sheet's revision schedules. 

# Remarks

Additionally included Revisions will always participate in the sheet's revision schedules. Normally a Revision is scheduled in the revision schedule because one of its associated RevisionClouds is present on the sheet. 

The additional project revision ids setting corresponds to the sheet's Revisions On Sheet parameter.

# Examples

CopyC#
    
    
    public static void AddAdditionalRevisionsToSheet(ViewSheet viewSheet, String toMatch)
    {
        Document doc = viewSheet.Document;
    
        ICollection<ElementId> revisions = viewSheet.GetAdditionalRevisionIds();
    
        // Find revisions whose description matches input string
        FilteredElementCollector collector = new FilteredElementCollector(doc);
        collector.OfCategory(BuiltInCategory.OST_Revisions);
        collector.WhereElementIsNotElementType();
        if (revisions.Count > 0)
            collector.Excluding(revisions);
    
        // Check if revision should be added
        foreach (Element revision in collector)
        {
            Parameter descriptionParam = revision.get_Parameter(BuiltInParameter.PROJECT_REVISION_REVISION_DESCRIPTION);
            String description = descriptionParam.AsString();
            if (description.Contains(toMatch))
                revisions.Add(revision.Id);
        }
    
        if (revisions.Count > 0)
        {
            // Apply the new list of revisions
            using (Transaction t = new Transaction(doc, "Add revisions to sheet"))
            {
                t.Start();
                viewSheet.SetAdditionalRevisionIds(revisions);
                t.Commit();
            }
        }
    }

CopyVB.NET
    
    
    Public Shared Sub AddAdditionalRevisionsToSheet(viewSheet As ViewSheet, toMatch As [String])
        Dim doc As Document = viewSheet.Document
    
        Dim revisions As ICollection(Of ElementId) = viewSheet.GetAdditionalRevisionIds()
    
        ' Find revisions whose description matches input string
        Dim collector As New FilteredElementCollector(doc)
        collector.OfCategory(BuiltInCategory.OST_Revisions)
        collector.WhereElementIsNotElementType()
        If revisions.Count > 0 Then
            collector.Excluding(revisions)
        End If
    
        ' Check if revision should be added
        For Each revision As Element In collector
            Dim descriptionParam As Parameter = revision.Parameter(BuiltInParameter.PROJECT_REVISION_REVISION_DESCRIPTION)
            Dim description As [String] = descriptionParam.AsString()
            If description.Contains(toMatch) Then
                revisions.Add(revision.Id)
            End If
        Next
    
        If revisions.Count > 0 Then
            ' Apply the new list of revisions
            Using t As New Transaction(doc, "Add revisions to sheet")
                t.Start()
                viewSheet.SetAdditionalRevisionIds(revisions)
                t.Commit()
            End Using
        End If
    End Sub

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentException](2e6e4206-97a8-dd4b-df5d-4269f4bb6088.md) | One or more ElementIds in projectRevisionIds do not correspond to a Revision element. |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | A non-optional argument was null |
  
# See Also

[ViewSheet Class](af2ee879-173d-df3a-9793-8d5750a17b49.md)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)