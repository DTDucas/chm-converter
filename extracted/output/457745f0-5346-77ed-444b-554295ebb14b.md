

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
ExternalResourceReference..::..CreateLocalResource Method   
[ExternalResourceReference Class](ffad9c15-8fc9-fbfd-f328-101533f4cf74.md) See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Creates an ExternalResourceReference representing a local file managed by Revit's built-in server. 

**Namespace:** [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2015 

# Syntax

C#  
---  
      
    
    public static [ExternalResourceReference](ffad9c15-8fc9-fbfd-f328-101533f4cf74.md) CreateLocalResource(
    	[Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md) doc,
    	[ExternalResourceType](3fbd8c3c-1fa9-1f70-044e-b9e92f025a5e.md) resourceType,
    	[ModelPath](40a84c72-e4b8-72ac-2f71-3216c66a11b3.md) path,
    	[PathType](dab91714-40d3-bc4a-6c5e-1b5eb504e341.md) pathType
    )  
  
Visual Basic  
---  
      
    
    Public Shared Function CreateLocalResource ( _
    	doc As [Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md), _
    	resourceType As [ExternalResourceType](3fbd8c3c-1fa9-1f70-044e-b9e92f025a5e.md), _
    	path As [ModelPath](40a84c72-e4b8-72ac-2f71-3216c66a11b3.md), _
    	pathType As [PathType](dab91714-40d3-bc4a-6c5e-1b5eb504e341.md) _
    ) As [ExternalResourceReference](ffad9c15-8fc9-fbfd-f328-101533f4cf74.md)  
  
Visual C++  
---  
      
    
    public:
    static [ExternalResourceReference](ffad9c15-8fc9-fbfd-f328-101533f4cf74.md)^ CreateLocalResource(
    	[Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md)^ doc, 
    	[ExternalResourceType](3fbd8c3c-1fa9-1f70-044e-b9e92f025a5e.md)^ resourceType, 
    	[ModelPath](40a84c72-e4b8-72ac-2f71-3216c66a11b3.md)^ path, 
    	[PathType](dab91714-40d3-bc4a-6c5e-1b5eb504e341.md) pathType
    )  
  
#### Parameters

doc
    Type: [Autodesk.Revit.DB..::..Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md) The document containing the reference. If the PathType is relative, the path will be made relative to the location of this Document. (If this Document belongs to a workshared model, the reference will be relative to the central model.) 

resourceType
    Type: [Autodesk.Revit.DB..::..ExternalResourceType](3fbd8c3c-1fa9-1f70-044e-b9e92f025a5e.md) The type of the external resource. 

path
    Type: [Autodesk.Revit.DB..::..ModelPath](40a84c72-e4b8-72ac-2f71-3216c66a11b3.md) A path to the external file. This path must be absolute. If the PathType is relative, then Revit will relativize the path according to the location of the given Document. 

pathType
    Type: [Autodesk.Revit.DB..::..PathType](dab91714-40d3-bc4a-6c5e-1b5eb504e341.md) An enum indicating the type of path which the ExternalResourceReference should use. The PathType must be PathType.Server if the reference is to a Revit model on Revit Server. The PathType must be PathType.Absolute if the reference is local but the host model or host's central model are on Revit Server. 

#### Return Value

The newly-created ExternalResourceReference. 

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentException](2e6e4206-97a8-dd4b-df5d-4269f4bb6088.md) | The PathType.Enum value is not valid for this resource type or Document location. PathType.Content is not valid for Revit links. The PathType must be PathType.Server if the resource is on Revit Server and is only valid for Revit links. The PathType must be PathType.Absolute if the host document or the host document's central model are on Revit Server. -or- The given path path is a cloud path which is not supported in this method. |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | A non-optional argument was null |
| [Autodesk.Revit.Exceptions..::..ArgumentOutOfRangeException](60f148c9-ece0-a6bb-4e12-bb4a9c8c8a24.md) | A value passed for an enumeration argument is not a member of that enumeration |
| [Autodesk.Revit.Exceptions..::..InvalidOperationException](9e715f03-3884-e539-4dd6-8d7545733adc.md) | The model is not allowed to access. |
  
# See Also

[ExternalResourceReference Class](ffad9c15-8fc9-fbfd-f328-101533f4cf74.md)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)