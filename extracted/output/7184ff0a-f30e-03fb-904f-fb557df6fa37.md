

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
Document..::..PostFailure Method   
[Document Class](db03274b-a107-aa32-9034-f3e0df4bb1ec.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Posts a failure to be displayed to the user at the end of transaction. 

**Namespace:** [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2011 

# Syntax

C#  
---  
      
    
    public [FailureMessageKey](f0fa1b40-5df3-ddaf-e38d-85bd438a89e3.md) PostFailure(
    	[FailureMessage](d0795bd6-f092-90f2-5c2c-3876e616454c.md) failure
    )  
  
Visual Basic  
---  
      
    
    Public Function PostFailure ( _
    	failure As [FailureMessage](d0795bd6-f092-90f2-5c2c-3876e616454c.md) _
    ) As [FailureMessageKey](f0fa1b40-5df3-ddaf-e38d-85bd438a89e3.md)  
  
Visual C++  
---  
      
    
    public:
    [FailureMessageKey](f0fa1b40-5df3-ddaf-e38d-85bd438a89e3.md)^ PostFailure(
    	[FailureMessage](d0795bd6-f092-90f2-5c2c-3876e616454c.md)^ failure
    )  
  
#### Parameters

failure
    Type: [Autodesk.Revit.DB..::..FailureMessage](d0795bd6-f092-90f2-5c2c-3876e616454c.md) The failure to be posted. 

#### Return Value

A unique key that identifies posted failure message in a document. If exactly the same error is posted more than once, and not removed between the postings, returned key will be the same every time. 

# Remarks

If code inside transaction detects a problem that needs to be communicated to the user, it should report these conditions via this method. Failures will be validated and possibly resolved at the end of transaction. Warnings posted via this method will not be stored in the document after they are resolved. A unique key returned by postFailure can be stored for the lifetime of transaction and used to remove failure message if it is no longer relevant. 

# Examples

CopyC#
    
    
    // Execute function for an Updater triggered when new FamilyInstances are added
    public void Execute(UpdaterData data)
    {
       Document doc = data.GetDocument();
       Autodesk.Revit.ApplicationServices.Application app = doc.Application;
       foreach (ElementId id in data.GetModifiedElementIds())
       {
          AnalyticalMember fi = doc.GetElement(id) as AnalyticalMember;
          if (fi.StructuralRole == AnalyticalStructuralRole.StructuralRoleBeam)
          {
             if (fi.IsSingleCurve() == true)
             {
                Curve beamCurve = fi.GetCurve();
                // enforce beam length minimum of 12 inches
                if (beamCurve.Length < 12.0)
                {
                   FailureMessage failMessage =
                         new FailureMessage(BuiltInFailures.CurveFailures.TooShort);
                   failMessage.SetFailingElement(id);
                   doc.PostFailure(failMessage);
                }
             }
          }
       }
    }

CopyVB.NET
    
    
    ' Execute function for an Updater triggered when new FamilyInstances are added
    Public Sub Execute(data As UpdaterData) Implements IUpdater.Execute
       Dim doc As Document = data.GetDocument()
       Dim app As Autodesk.Revit.ApplicationServices.Application = doc.Application
       For Each id As ElementId In data.GetModifiedElementIds()
          Dim fi As FamilyInstance = TryCast(doc.GetElement(id), FamilyInstance)
          If fi.StructuralType = StructuralType.Beam Then
             Dim analyticalModel As Autodesk.Revit.DB.Structure.AnalyticalElement = Nothing
             Dim relManager As Autodesk.Revit.DB.Structure.AnalyticalToPhysicalAssociationManager = Autodesk.Revit.DB.Structure.AnalyticalToPhysicalAssociationManager.GetAnalyticalToPhysicalAssociationManager(doc)
    
             If (relManager Is Nothing) Then
                Exit Sub
             End If
    
             Dim counterpartId As ElementId = relManager.GetAssociatedElementId(fi.Id)
             If (counterpartId Is Nothing) Then
                Exit Sub
             End If
    
             analyticalModel = doc.GetElement(counterpartId)
             If analyticalModel.IsSingleCurve() = True Then
                Dim beamCurve As Curve = analyticalModel.GetCurve()
                ' enforce beam length minimum of 12 inches
                If beamCurve.Length < 12.0 Then
                   Dim failMessage As New FailureMessage(BuiltInFailures.CurveFailures.TooShort)
                   failMessage.SetFailingElement(id)
                   doc.PostFailure(failMessage)
                End If
             End If
          End If
       Next
    End Sub

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | A non-optional argument was null |
| [Autodesk.Revit.Exceptions..::..InvalidOperationException](9e715f03-3884-e539-4dd6-8d7545733adc.md) | Document must be in state of accepting posted failures and the failures must be appropriate for that current state. |
| [Autodesk.Revit.Exceptions..::..ModificationForbiddenException](53205486-5917-7c33-8e67-e362106ddc97.md) | The document is in failure mode: an operation has failed, and Revit requires the user to either cancel the operation or fix the problem (usually by deleting certain elements). -or- The document is being loaded, or is in the midst of another sensitive process. |
| [Autodesk.Revit.Exceptions..::..ModificationOutsideTransactionException](8f025460-c283-ea99-aa8a-5a36e11528f4.md) | The document has no open transaction. |
  
# See Also

[Document Class](db03274b-a107-aa32-9034-f3e0df4bb1ec.md)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)