

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
AnalyticalToPhysicalAssociationManager..::..AddAssociation Method (ElementId, ElementId)  
[AnalyticalToPhysicalAssociationManager Class](0f7f395b-3f70-aa6e-e584-b70c11f767ad.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Adds a new association between an analytical element and a physical element. 

**Namespace:** [Autodesk.Revit.DB.Structure](d586b341-f687-9d90-e96d-255806b7d4fc.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2023 

# Syntax

C#  
---  
      
    
    public void AddAssociation(
    	[ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md) analyticalElementId,
    	[ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md) physicalElementId
    )  
  
Visual Basic  
---  
      
    
    Public Sub AddAssociation ( _
    	analyticalElementId As [ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md), _
    	physicalElementId As [ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md) _
    )  
  
Visual C++  
---  
      
    
    public:
    void AddAssociation(
    	[ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md)^ analyticalElementId, 
    	[ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md)^ physicalElementId
    )  
  
#### Parameters

analyticalElementId
    Type: [Autodesk.Revit.DB..::..ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md) Id of the analytical element. 

physicalElementId
    Type: [Autodesk.Revit.DB..::..ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md) Id of the physical element. 

# Remarks

The arguments must be ids of an analytical and of a physical element that don't have other associations, otherwise an exception is thrown. Physical element can have one of these categories: 

  * Columns 
  * Curtain Wall Panels 
  * Floors 
  * Generic Models 
  * Mass 
  * Parts 
  * Railings 
  * Ramps 
  * Roofs 
  * Stairs 
  * Structural Columns 
  * Structural Foundation 
  * Structural Framing 
  * Structural Trusses 
  * Structural Beam System 
  * Walls 

Analytical element can have one of these categories: 
  * Analytical Member 
  * Analytical Panel 



# Examples

CopyC#
    
    
    using (Transaction trans = new Transaction(doc, "AddAssociationBetweenPhysicalAndAnalyticalElements"))
    {
       trans.Start();
    
       ElementId idAnalyticalElem = GetSelectedObject(activeDoc, "Please select analytical element");
       ElementId idPhysicalElem = GetSelectedObject(activeDoc, "Please select physical element");
    
       //gets the AnalyticalToPhysicalAssociationManager for the current document
       AnalyticalToPhysicalAssociationManager analyticalToPhysicalManager = AnalyticalToPhysicalAssociationManager.GetAnalyticalToPhysicalAssociationManager(doc);
       if (analyticalToPhysicalManager == null)
          return Result.Failed;
    
       //creates a new association between physical and analytical selected elements
       analyticalToPhysicalManager.AddAssociation(idAnalyticalElem, idPhysicalElem);
    
       trans.Commit();

CopyVB.NET
    
    
    Using trans As Transaction = New Transaction(doc, "AddAssociationBetweenPhysicalAndAnalyticalElements")
        trans.Start()
        Dim idAnalyticalElem = GetSelectedObject(activeDoc, "Please select analytical element")
        Dim idPhysicalElem = GetSelectedObject(activeDoc, "Please select physical element")
    
        'gets the AnalyticalToPhysicalAssociationManager for the current document
        Dim analyticalToPhysicalManager = AnalyticalToPhysicalAssociationManager.GetAnalyticalToPhysicalAssociationManager(doc)
        If analyticalToPhysicalManager Is Nothing Then Return Result.Failed
    
        'creates a new association between physical and analytical selected elements
        analyticalToPhysicalManager.AddAssociation(idAnalyticalElem, idPhysicalElem)
        trans.Commit()

CopyVB.NET
    
    
    Using trans As Transaction = New Transaction(doc, "AddAssociationBetweenPhysicalAndAnalyticalElements")
        trans.Start()
        Dim idAnalyticalElem = GetSelectedObject(activeDoc, "Please select analytical element")
        Dim idPhysicalElem = GetSelectedObject(activeDoc, "Please select physical element")
    
        'gets the AnalyticalToPhysicalAssociationManager for the current document
        Dim analyticalToPhysicalManager = AnalyticalToPhysicalAssociationManager.GetAnalyticalToPhysicalAssociationManager(doc)
        If analyticalToPhysicalManager Is Nothing Then Return Result.Failed
    
        'creates a new association between physical and analytical selected elements
        analyticalToPhysicalManager.AddAssociation(idAnalyticalElem, idPhysicalElem)
        trans.Commit()

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentException](2e6e4206-97a8-dd4b-df5d-4269f4bb6088.md) | Analytical id is not valid or has already defined another association. -or- Physical id is not valid or has already defined another association. |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | A non-optional argument was null |
  
# See Also

[AnalyticalToPhysicalAssociationManager Class](0f7f395b-3f70-aa6e-e584-b70c11f767ad.md)

[AddAssociation Overload](591f396b-243c-61d3-ffdf-6d9fbcf31417.md)

[Autodesk.Revit.DB.Structure Namespace](d586b341-f687-9d90-e96d-255806b7d4fc.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)