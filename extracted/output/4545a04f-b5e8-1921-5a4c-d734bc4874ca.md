

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
ItemFactoryBase..::..NewFamilyInstance Method (Reference, Line, FamilySymbol)  
[ItemFactoryBase Class](cba2c84a-22c0-e6e7-a99c-67656901853a.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Inserts a new instance of a family onto a face referenced by the input Reference instance, using a line on that face for its position, and a type/symbol.

**Namespace:** [Autodesk.Revit.Creation](ded320da-058a-4edd-0418-0582389559a7.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)

# Syntax

C#  
---  
      
    
    public [FamilyInstance](0d2231f8-91e6-794f-92ae-16aad8014b27.md) NewFamilyInstance(
    	[Reference](d28155ae-817b-1f31-9c3f-c9c6a28acc0d.md) reference,
    	[Line](e7329450-434a-918b-661c-65e15e0585a5.md) position,
    	[FamilySymbol](a1acaed0-6a62-4c1d-94f5-4e27ce0923d3.md) symbol
    )  
  
Visual Basic  
---  
      
    
    Public Function NewFamilyInstance ( _
    	reference As [Reference](d28155ae-817b-1f31-9c3f-c9c6a28acc0d.md), _
    	position As [Line](e7329450-434a-918b-661c-65e15e0585a5.md), _
    	symbol As [FamilySymbol](a1acaed0-6a62-4c1d-94f5-4e27ce0923d3.md) _
    ) As [FamilyInstance](0d2231f8-91e6-794f-92ae-16aad8014b27.md)  
  
Visual C++  
---  
      
    
    public:
    [FamilyInstance](0d2231f8-91e6-794f-92ae-16aad8014b27.md)^ NewFamilyInstance(
    	[Reference](d28155ae-817b-1f31-9c3f-c9c6a28acc0d.md)^ reference, 
    	[Line](e7329450-434a-918b-661c-65e15e0585a5.md)^ position, 
    	[FamilySymbol](a1acaed0-6a62-4c1d-94f5-4e27ce0923d3.md)^ symbol
    )  
  
#### Parameters

reference
    Type: [Autodesk.Revit.DB..::..Reference](d28155ae-817b-1f31-9c3f-c9c6a28acc0d.md)A reference to a face.

position
    Type: [Autodesk.Revit.DB..::..Line](e7329450-434a-918b-661c-65e15e0585a5.md)A line on the face defining where the symbol is to be placed.

symbol
    Type: [Autodesk.Revit.DB..::..FamilySymbol](a1acaed0-6a62-4c1d-94f5-4e27ce0923d3.md)A FamilySymbol object that represents the type of the instance that is to be inserted. Note that this symbol must represent a family whose [FamilyPlacementType](7fcd2fda-21c3-9b9b-8ef3-ae2e53e02a05.md) is WorkPlaneBased or CurveBased.

#### Return Value

An instance of the new object if creation was successful, otherwise nullNothingnullptra null reference (Nothing in Visual Basic).

# Remarks

Use this method to insert one family instance on a face of another element, using a line on the face to define the position and direction of the new symbol. 

The type/symbol that is used must be loaded into the document before this method is called. Families and their symbols can be loaded using the Document.LoadFamily or Document.LoadFamilySymbol methods.

The host object must support insertion of instances, otherwise this method will fail. If the instance fails to be created an exception may be thrown.

Note: if the created family instance includes nested instances, the API framework will automatically regenerate the document during this method call.

# Examples

CopyC#
    
    
    public void PlaceStiffenerOnWallFaceRef(Autodesk.Revit.DB.Document doc)
    {
        FilteredElementCollector wallCollector = new FilteredElementCollector(doc);
        wallCollector.OfClass(typeof(Wall));
        Wall wall = wallCollector.FirstElement() as Wall;
    
        // The structural stiffeners family type is compatible with line-based face placement
        FilteredElementCollector fsCollector = new FilteredElementCollector(doc);
        fsCollector.OfClass(typeof(FamilySymbol)).OfCategory(BuiltInCategory.OST_StructuralStiffener);
        FamilySymbol stiffenerSymbol = fsCollector.FirstElement() as FamilySymbol;
    
        // Get side face of wall
        IList<Reference> sideFaces = HostObjectUtils.GetSideFaces(wall, ShellLayerType.Exterior);
        Reference sideFaceRef = sideFaces[0];
    
        // Generate line for path
        Face face = wall.GetGeometryObjectFromReference(sideFaceRef) as Face;
        BoundingBoxUV bbox = face.GetBoundingBox();
        UV lowerLeft = bbox.Min;
        UV upperRight = bbox.Max;
        double deltaU = upperRight.U - lowerLeft.U;
        double deltaV = upperRight.V - lowerLeft.V;
        double vOffset = deltaV * 0.60; // 60% up the wall face
    
        UV firstPoint = lowerLeft + new UV(deltaU * 0.20, vOffset);
        UV lastPoint = lowerLeft + new UV(deltaU * 0.80, vOffset);
    
        Line line = Line.CreateBound(face.Evaluate(firstPoint), face.Evaluate(lastPoint));
    
        doc.Create.NewFamilyInstance(sideFaceRef, line, stiffenerSymbol);
    }

CopyVB.NET
    
    
    Public Sub PlaceStiffenerOnWallFaceRef(doc As Autodesk.Revit.DB.Document)
        Dim wallCollector As New FilteredElementCollector(doc)
        wallCollector.OfClass(GetType(Wall))
        Dim wall As Wall = TryCast(wallCollector.FirstElement(), Wall)
    
        ' The structural stiffeners family type is compatible with line-based face placement
        Dim fsCollector As New FilteredElementCollector(doc)
        fsCollector.OfClass(GetType(FamilySymbol)).OfCategory(BuiltInCategory.OST_StructuralStiffener)
        Dim stiffenerSymbol As FamilySymbol = TryCast(fsCollector.FirstElement(), FamilySymbol)
    
        ' Get side face of wall
        Dim sideFaces As IList(Of Reference) = HostObjectUtils.GetSideFaces(wall, ShellLayerType.Exterior)
        Dim sideFaceRef As Reference = sideFaces(0)
    
        ' Generate line for path
        Dim face As Face = TryCast(wall.GetGeometryObjectFromReference(sideFaceRef), Face)
        Dim bbox As BoundingBoxUV = face.GetBoundingBox()
        Dim lowerLeft As UV = bbox.Min
        Dim upperRight As UV = bbox.Max
        Dim deltaU As Double = upperRight.U - lowerLeft.U
        Dim deltaV As Double = upperRight.V - lowerLeft.V
        Dim vOffset As Double = deltaV * 0.6
        ' 60% up the wall face
        Dim firstPoint As UV = lowerLeft + New UV(deltaU * 0.2, vOffset)
        Dim lastPoint As UV = lowerLeft + New UV(deltaU * 0.8, vOffset)
    
        Dim line__1 As Line = Line.CreateBound(face.Evaluate(firstPoint), face.Evaluate(lastPoint))
    
        doc.Create.NewFamilyInstance(sideFaceRef, line__1, stiffenerSymbol)
    End Sub

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | Thrown when a non-optional argument was null. |
| [Autodesk.Revit.Exceptions..::..ArgumentException](2e6e4206-97a8-dd4b-df5d-4269f4bb6088.md) | Thrown when the function cannot get a face from the reference, or, when the family cannot be placed as line-based on an input face reference, because its FamilyPlacementType is not WorkPlaneBased or CurveBased |
| [Autodesk.Revit.Exceptions..::..ArgumentsInconsistentException](05972c68-fa6d-3a83-d720-ad84fbc4780f.md) | Thrown when the family cannot be placed on this line as it does not coincide with the input face. |
| [Autodesk.Revit.Exceptions..::..InvalidOperationException](9e715f03-3884-e539-4dd6-8d7545733adc.md) | Thrown when Revit is unable to place the family instance. |
| [Autodesk.Revit.Exceptions..::..ArgumentException](2e6e4206-97a8-dd4b-df5d-4269f4bb6088.md) | Thrown if The symbol is not active. |
  
# See Also

[ItemFactoryBase Class](cba2c84a-22c0-e6e7-a99c-67656901853a.md)

[NewFamilyInstance Overload](451ee414-cea0-e9bd-227b-c73bc93507dd.md)

[Autodesk.Revit.Creation Namespace](ded320da-058a-4edd-0418-0582389559a7.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)