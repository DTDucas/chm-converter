

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
Solid..::..IntersectWithCurve Method   
[Solid Class](7a3b5ac1-c66d-9f81-a11d-9bcd4e026295.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Calculates and returns the intersection between a curve and this solid. 

**Namespace:** [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2013 

# Syntax

C#  
---  
      
    
    public [SolidCurveIntersection](888716e3-376f-c4db-abe3-4e826c799656.md) IntersectWithCurve(
    	[Curve](400cc9b6-9ff7-de85-6fd8-c20002209d25.md) curve,
    	[SolidCurveIntersectionOptions](fce58e1d-47c7-9afb-d701-ec73d97d0f2b.md) options
    )  
  
Visual Basic  
---  
      
    
    Public Function IntersectWithCurve ( _
    	curve As [Curve](400cc9b6-9ff7-de85-6fd8-c20002209d25.md), _
    	options As [SolidCurveIntersectionOptions](fce58e1d-47c7-9afb-d701-ec73d97d0f2b.md) _
    ) As [SolidCurveIntersection](888716e3-376f-c4db-abe3-4e826c799656.md)  
  
Visual C++  
---  
      
    
    public:
    [SolidCurveIntersection](888716e3-376f-c4db-abe3-4e826c799656.md)^ IntersectWithCurve(
    	[Curve](400cc9b6-9ff7-de85-6fd8-c20002209d25.md)^ curve, 
    	[SolidCurveIntersectionOptions](fce58e1d-47c7-9afb-d701-ec73d97d0f2b.md)^ options
    )  
  
#### Parameters

curve
    Type: [Autodesk.Revit.DB..::..Curve](400cc9b6-9ff7-de85-6fd8-c20002209d25.md) The curve. 

options
    Type: [Autodesk.Revit.DB..::..SolidCurveIntersectionOptions](fce58e1d-47c7-9afb-d701-ec73d97d0f2b.md) The options. If NULL, the default options will be used. 

#### Return Value

The intersection results. 

# Examples

CopyC#
    
    
    private void FindColumnRebarIntersections(Document document, FamilyInstance column)
    {
        // We will be computing the total length of the rebar inside the column
        double totalRebarLengthInColumn = 0;
    
        // Find rebar hosted by this column
        RebarHostData rebarHostData = RebarHostData.GetRebarHostData(column);
        if (rebarHostData == null)
        {
            return;
        }
    
        IList<Rebar> rebars = rebarHostData.GetRebarsInHost();
        if (rebars.Count == 0)
        {
            return;
        }
    
        // Retrieve geometry of the column
        Options geomOptions = new Options();
        geomOptions.ComputeReferences = true;
        geomOptions.DetailLevel = ViewDetailLevel.Fine;
        GeometryElement elemGeometry = column.get_Geometry(geomOptions);
    
        // Examine all geometry primitives of the column
        foreach (GeometryObject elemPrimitive in elemGeometry)
        {
    
            // Skip objects that are not geometry instances
            GeometryInstance gInstance = elemPrimitive as GeometryInstance;
            if (gInstance == null)
            {
                continue;
            }
    
            // Retrieve geometry of each found geometry instance
            GeometryElement instGeometry = gInstance.GetInstanceGeometry();
            foreach (GeometryObject instPrimitive in instGeometry)
            {
    
                // Skip non-solid sobject
                Solid solid = instPrimitive as Solid;
                if (solid == null)
                {
                    continue;
                }
    
                SolidCurveIntersectionOptions intersectOptions = new SolidCurveIntersectionOptions();
                foreach (Rebar rebar in rebars)
                {
                    // Get the centerlines for the rebar to find their intersection with the column
                    bool selfIntersection = false;
                    bool suppresHooks = false;
                    bool suppresBends = false;
                    IList<Curve> curves = rebar.GetCenterlineCurves(selfIntersection, suppresHooks, suppresBends, MultiplanarOption.IncludeOnlyPlanarCurves, 0);
    
                    // Examine every segment of every curve of the centerline
                    foreach (Curve curve in curves)
                    {
                        SolidCurveIntersection intersection = solid.IntersectWithCurve(curve, intersectOptions);
                        for (int segment = 0; segment <= intersection.SegmentCount - 1; segment++)
                        {
                            // Calculate length of the rebar that is inside the column
                            Curve curveInside = intersection.GetCurveSegment(segment);
                            double rebarLengthInColumn = curveInside.Length;
                            totalRebarLengthInColumn = totalRebarLengthInColumn + rebarLengthInColumn;
                        }
                    }
    
                }
            }
        }
    
    }

CopyVB.NET
    
    
    Private Sub FindColumnRebarIntersections(document As Document, column As FamilyInstance)
        ' We will be computing the total length of the rebar inside the column
        Dim totalRebarLengthInColumn As Double = 0
    
        ' Find rebar hosted by this column
        Dim rebarHostData__1 As RebarHostData = RebarHostData.GetRebarHostData(column)
        If rebarHostData__1 Is Nothing Then
            Return
        End If
    
        Dim rebars As IList(Of Rebar) = rebarHostData__1.GetRebarsInHost()
        If rebars.Count = 0 Then
            Return
        End If
    
        ' Retrieve geometry of the column
        Dim geomOptions As New Options()
        geomOptions.ComputeReferences = True
        geomOptions.DetailLevel = ViewDetailLevel.Fine
        Dim elemGeometry As GeometryElement = column.Geometry(geomOptions)
    
        ' Examine all geometry primitives of the column
        For Each elemPrimitive As GeometryObject In elemGeometry
    
            ' Skip objects that are not geometry instances
            Dim gInstance As GeometryInstance = TryCast(elemPrimitive, GeometryInstance)
            If gInstance Is Nothing Then
                Continue For
            End If
    
            ' Retrieve geometry of each found geometry instance
            Dim instGeometry As GeometryElement = gInstance.GetInstanceGeometry()
            For Each instPrimitive As GeometryObject In instGeometry
    
                ' Skip non-solid sobject
                Dim solid As Solid = TryCast(instPrimitive, Solid)
                If solid Is Nothing Then
                    Continue For
                End If
    
                Dim intersectOptions As New SolidCurveIntersectionOptions()
                For Each rebar As Rebar In rebars
                    ' Get the centerlines for the rebar to find their intersection with the column
                    Dim selfIntersection As Boolean = False
                    Dim suppresHooks As Boolean = False
                    Dim suppresBends As Boolean = False
                    Dim curves As IList(Of Curve) = rebar.GetCenterlineCurves(selfIntersection, suppresHooks, suppresBends, MultiplanarOption.IncludeOnlyPlanarCurves, 0)
    
                    ' Examine every segment of every curve of the centerline
                    For Each curve As Curve In curves
                        Dim intersection As SolidCurveIntersection = solid.IntersectWithCurve(curve, intersectOptions)
                        For segment As Integer = 0 To intersection.SegmentCount - 1
                            ' Calculate length of the rebar that is inside the column
                            Dim curveInside As Curve = intersection.GetCurveSegment(segment)
                            Dim rebarLengthInColumn As Double = curveInside.Length
                            totalRebarLengthInColumn = totalRebarLengthInColumn + rebarLengthInColumn
                        Next
    
                    Next
                Next
            Next
        Next
    
    End Sub

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentException](2e6e4206-97a8-dd4b-df5d-4269f4bb6088.md) | The input curve is not bound. -or- The input solid is not a closed volume. |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | A non-optional argument was NULL |
  
# See Also

[Solid Class](7a3b5ac1-c66d-9f81-a11d-9bcd4e026295.md)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)