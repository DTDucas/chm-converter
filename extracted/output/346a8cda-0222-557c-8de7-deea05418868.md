

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
WorksharingUtils..::..GetModelUpdatesStatus Method   
[WorksharingUtils Class](ae7857a0-4e9b-f9c1-84c7-8b250af68068.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Gets the status of a single element in the central model. 

**Namespace:** [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2012 

# Syntax

C#  
---  
      
    
    public static [ModelUpdatesStatus](2fc35e00-cdf2-8368-e6a6-032725492cbe.md) GetModelUpdatesStatus(
    	[Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md) document,
    	[ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md) elementId
    )  
  
Visual Basic  
---  
      
    
    Public Shared Function GetModelUpdatesStatus ( _
    	document As [Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md), _
    	elementId As [ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md) _
    ) As [ModelUpdatesStatus](2fc35e00-cdf2-8368-e6a6-032725492cbe.md)  
  
Visual C++  
---  
      
    
    public:
    static [ModelUpdatesStatus](2fc35e00-cdf2-8368-e6a6-032725492cbe.md) GetModelUpdatesStatus(
    	[Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md)^ document, 
    	[ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md)^ elementId
    )  
  
#### Parameters

document
    Type: [Autodesk.Revit.DB..::..Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md) The document containing the element. 

elementId
    Type: [Autodesk.Revit.DB..::..ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md) The id of the element. 

#### Return Value

The status of the element in the local session versus the central model. 

# Remarks

This method returns a locally cached value which may not be up to date with the current state of the element in the central. Because of this, the return value is suitable for reporting to an interactive user (e.g. via a mechanism similar to Worksharing display mode), but cannot be considered a reliable indication of whether the element can be immediately edited by the application. Also, the return value may not be dependable in the middle of a local transaction. See the remarks on [WorksharingUtils](ae7857a0-4e9b-f9c1-84c7-8b250af68068.md) for more details. 

For performance reasons, the model is not validated to be workshared, and the element id is also not validated; the element will not be expanded.

# Examples

CopyC#
    
    
    public static bool AttemptToCheckoutInAdvance(Element element)
    {
        Document doc = element.Document;
        String categoryName = element.Category.Name;
    
        // Checkout attempt
        ICollection<ElementId> checkedOutIds = WorksharingUtils.CheckoutElements(doc, new ElementId[] { element.Id });
    
        // Confirm checkout
        bool checkedOutSuccessfully = checkedOutIds.Contains(element.Id);
    
        if (!checkedOutSuccessfully)
        {
            TaskDialog.Show("Element is not checked out", "Cannot edit the " + categoryName + " element - " +
                            "it was not checked out successfully and may be checked out to another.");
            return false;
        }
    
        // If element is updated in central or deleted in central, it is not editable
        ModelUpdatesStatus updatesStatus = WorksharingUtils.GetModelUpdatesStatus(doc, element.Id);
        if (updatesStatus == ModelUpdatesStatus.DeletedInCentral || updatesStatus == ModelUpdatesStatus.UpdatedInCentral)
        {
            TaskDialog.Show("Element is not up to date", "Cannot edit the " + categoryName + " element - " +
                            "it is not up to date with central, but it is checked out.");
            return false;
        }
    
        return true;
    }

CopyVB.NET
    
    
    Public Shared Function AttemptToCheckoutInAdvance(element As Element) As Boolean
        Dim doc As Document = element.Document
        Dim categoryName As [String] = element.Category.Name
    
        ' Checkout attempt
        Dim checkedOutIds As ICollection(Of ElementId) = WorksharingUtils.CheckoutElements(doc, New ElementId() {element.Id})
    
        ' Confirm checkout
        Dim checkedOutSuccessfully As Boolean = checkedOutIds.Contains(element.Id)
    
        If Not checkedOutSuccessfully Then
            TaskDialog.Show("Element is not checked out", "Cannot edit the " + categoryName + " element - " + "it was not checked out successfully and may be checked out to another.")
            Return False
        End If
    
        ' If element is updated in central or deleted in central, it is not editable
        Dim updatesStatus As ModelUpdatesStatus = WorksharingUtils.GetModelUpdatesStatus(doc, element.Id)
        If updatesStatus = ModelUpdatesStatus.DeletedInCentral OrElse updatesStatus = ModelUpdatesStatus.UpdatedInCentral Then
            TaskDialog.Show("Element is not up to date", "Cannot edit the " + categoryName + " element - " + "it is not up to date with central, but it is checked out.")
            Return False
        End If
    
        Return True
    End Function

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | A non-optional argument was null |
  
# See Also

[WorksharingUtils Class](ae7857a0-4e9b-f9c1-84c7-8b250af68068.md)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)