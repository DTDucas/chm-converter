

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
ScheduleDefinition..::..AddField Method (SchedulableField)  
[ScheduleDefinition Class](420696e3-f3ec-1a1d-1205-36a8119d81e5.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Adds a regular field at the end of the list. 

**Namespace:** [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2013 

# Syntax

C#  
---  
      
    
    public [ScheduleField](3d6b0eb5-ed36-278d-a5df-38b6d600e876.md) AddField(
    	[SchedulableField](84f03bb5-a9b8-581c-631c-6240b4954099.md) schedulableField
    )  
  
Visual Basic  
---  
      
    
    Public Function AddField ( _
    	schedulableField As [SchedulableField](84f03bb5-a9b8-581c-631c-6240b4954099.md) _
    ) As [ScheduleField](3d6b0eb5-ed36-278d-a5df-38b6d600e876.md)  
  
Visual C++  
---  
      
    
    public:
    [ScheduleField](3d6b0eb5-ed36-278d-a5df-38b6d600e876.md)^ AddField(
    	[SchedulableField](84f03bb5-a9b8-581c-631c-6240b4954099.md)^ schedulableField
    )  
  
#### Parameters

schedulableField
    Type: [Autodesk.Revit.DB..::..SchedulableField](84f03bb5-a9b8-581c-631c-6240b4954099.md) A SchedulableField object representing the field. 

#### Return Value

The new field. 

# Examples

CopyC#
    
    
    /// <summary>
    /// Add fields to view schedule.
    /// </summary>
    /// <param name="schedules">List of view schedule.</param>
    public void AddFieldToSchedule(Document document, List<ViewSchedule> schedules)
    {
        using (Transaction transaction = new Transaction(document, "Adding fields to schedule"))
        {
            transaction.Start();
    
            foreach (ViewSchedule vs in schedules)
            {
               //Get all schedulable fields from view schedule definition.
               IList<SchedulableField> schedulableFields = vs.Definition.GetSchedulableFields();
    
               foreach (SchedulableField sf in schedulableFields)
               {
                   bool fieldAlreadyAdded = false;
                   //Get all schedule field ids
                   IList<ScheduleFieldId> ids = vs.Definition.GetFieldOrder();
                   foreach (ScheduleFieldId id in ids)
                   {
                       // If the GetSchedulableField() method of gotten schedule field returns same
                       // schedulable field, it means the field is already added to the view schedule.
                       if (vs.Definition.GetField(id).GetSchedulableField() == sf)
                       {
                           fieldAlreadyAdded = true;
                           break;
                       }
                   }
    
                   //If schedulable field doesn't exist in view schedule, add it.
                   if (fieldAlreadyAdded == false)
                   {
                       vs.Definition.AddField(sf);
                   }
               }
            }
    
            transaction.Commit();
        }   
    }

CopyVB.NET
    
    
    ' <summary>
    ' Add fields to view schedule.
    ' </summary>
    ' <param name="schedules">List of view schedule.</param>
    Public Sub AddFieldToSchedule(document As Document, schedules As List(Of ViewSchedule))
        Using transaction As New Transaction(document, "Adding fields to schedule")
            transaction.Start()
    
            For Each vs As ViewSchedule In schedules
                'Get all schedulable fields from view schedule definition.
                Dim schedulableFields As IList(Of SchedulableField) = vs.Definition.GetSchedulableFields()
    
                For Each sf As SchedulableField In schedulableFields
                    Dim fieldAlreadyAdded As Boolean = False
                    'Get all schedule field ids
                    Dim ids As IList(Of ScheduleFieldId) = vs.Definition.GetFieldOrder()
                    For Each id As ScheduleFieldId In ids
                        ' If the GetSchedulableField() method of gotten schedule field returns same
                        ' schedulable field, it means the field is already added to the view schedule.
                        If vs.Definition.GetField(id).GetSchedulableField() = sf Then
                            fieldAlreadyAdded = True
                            Exit For
                        End If
                    Next
    
                    'If schedulable field doesn't exist in view schedule, add it.
                    If fieldAlreadyAdded = False Then
                        vs.Definition.AddField(sf)
                    End If
                Next
            Next
    
            transaction.Commit()
        End Using
    End Sub

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentException](2e6e4206-97a8-dd4b-df5d-4269f4bb6088.md) | The field specified by schedulableField may not included in this ScheduleDefinition. -or- The field specified by schedulableField is already included in this ScheduleDefinition. |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | A non-optional argument was null |
  
# See Also

[ScheduleDefinition Class](420696e3-f3ec-1a1d-1205-36a8119d81e5.md)

[AddField Overload](e9c2fbe0-2bdd-f556-f870-54714e2ef939.md)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)