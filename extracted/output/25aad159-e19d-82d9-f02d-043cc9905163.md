

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
Selection..::..PickObjects Method (ObjectType, ISelectionFilter, String)  
[Selection Class](31b73d46-7d67-5dbb-4dad-80aa597c9afc.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Prompts the user to select multiple objects which pass a custom filter while showing a custom status prompt string.

**Namespace:** [Autodesk.Revit.UI.Selection](11785869-cc9e-03fc-97db-767a59af10a1.md)**Assembly:** RevitAPIUI (in RevitAPIUI.dll) Version: 24.0.0.0 (24.0.0.0)

# Syntax

C#  
---  
      
    
    public IList<[Reference](d28155ae-817b-1f31-9c3f-c9c6a28acc0d.md)> PickObjects(
    	[ObjectType](2d0cbbba-d4ab-84b7-b081-36c14769d82c.md) objectType,
    	[ISelectionFilter](d552f44b-221c-0ecd-d001-41a5099b2f9f.md) selectionFilter,
    	string statusPrompt
    )  
  
Visual Basic  
---  
      
    
    Public Function PickObjects ( _
    	objectType As [ObjectType](2d0cbbba-d4ab-84b7-b081-36c14769d82c.md), _
    	selectionFilter As [ISelectionFilter](d552f44b-221c-0ecd-d001-41a5099b2f9f.md), _
    	statusPrompt As String _
    ) As IList(Of [Reference](d28155ae-817b-1f31-9c3f-c9c6a28acc0d.md))  
  
Visual C++  
---  
      
    
    public:
    IList<[Reference](d28155ae-817b-1f31-9c3f-c9c6a28acc0d.md)^>^ PickObjects(
    	[ObjectType](2d0cbbba-d4ab-84b7-b081-36c14769d82c.md) objectType, 
    	[ISelectionFilter](d552f44b-221c-0ecd-d001-41a5099b2f9f.md)^ selectionFilter, 
    	String^ statusPrompt
    )  
  
#### Parameters

objectType
    Type: [Autodesk.Revit.UI.Selection..::..ObjectType](2d0cbbba-d4ab-84b7-b081-36c14769d82c.md)Specifies the type of object to be selected.

selectionFilter
    Type: [Autodesk.Revit.UI.Selection..::..ISelectionFilter](d552f44b-221c-0ecd-d001-41a5099b2f9f.md)The selection filter.

statusPrompt
    Type: System..::..StringThe message shown on the status bar.

#### Return Value

A collection of references selected by the user.

Note: if the user cancels the operation (for example, through ESC), the method will throw an OperationCanceledException instance. 

# Remarks

The user will be shown "Finish" and "Cancel" buttons on the dialog bar to complete the selection operation. Uncheck the "Multiple" check-box to select single object and it will return the selected object directly.

Revit users will be permitted to manipulate the Revit view (zooming, panning, and rotating the view), but will not be permitted to click other items in the Revit user interface. Users are not permitted to switch the active view, close the active document or Revit application in the pick session, otherwise an exception will be thrown.

The selection will not be automatically added to the active selection buffer.

Note: this method must not be called during dynamic update, otherwise ForbiddenForDynamicUpdateException will be thrown.

# Examples

CopyC#
    
    
    public void SelectPlanarFaces(Autodesk.Revit.DB.Document document)
    {
        UIDocument uidoc = new UIDocument(document);
        ISelectionFilter selFilter = new PlanarFacesSelectionFilter(document);
        IList<Reference> faces = uidoc.Selection.PickObjects(ObjectType.Face, selFilter, "Select multiple planar faces");
    }
    
    public class PlanarFacesSelectionFilter : ISelectionFilter
    {
        Document doc = null;
        public PlanarFacesSelectionFilter(Document document)
        {
            doc = document;
        }
    
        public bool AllowElement(Element element)
        {
            return true;
        }
    
        public bool AllowReference(Reference refer, XYZ point)
        {   
            if (doc.GetElement(refer).GetGeometryObjectFromReference(refer) is PlanarFace)
            {
                return true; // Only return true for planar faces. Non-planar faces will not be selectable
            }
            return false;
        }
    }

CopyVB.NET
    
    
    Public Sub SelectPlanarFaces(document As Autodesk.Revit.DB.Document)
        Dim uidoc As New UIDocument(document)
        Dim selFilter As ISelectionFilter = New PlanarFacesSelectionFilter(document)
        Dim faces As IList(Of Reference) = uidoc.Selection.PickObjects(ObjectType.Face, selFilter, "Select multiple planar faces")
    End Sub
    
    Public Class PlanarFacesSelectionFilter
        Implements ISelectionFilter
        Private doc As Document = Nothing
        Public Sub New(document As Document)
            doc = document
        End Sub
    
        Public Function AllowElement(element As Element) As Boolean Implements ISelectionFilter.AllowElement
            Return True
        End Function
    
        Public Function AllowReference(refer As Reference, point As XYZ) As Boolean Implements ISelectionFilter.AllowReference
            If TypeOf doc.GetElement(refer).GetGeometryObjectFromReference(refer) Is PlanarFace Then
                ' Only return true for planar faces. Non-planar faces will not be selectable
                Return True
            End If
            Return False
        End Function
    End Class

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentOutOfRangeException](60f148c9-ece0-a6bb-4e12-bb4a9c8c8a24.md) | Thrown when the objectType is not a recognized value. |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | Thrown when the selectionFilter is nullNothingnullptra null reference (Nothing in Visual Basic) or statusPrompt is nullNothingnullptra null reference (Nothing in Visual Basic). |
| [Autodesk.Revit.Exceptions..::..OperationCanceledException](aea34480-ceb5-b49f-129d-0799e7bb1c21.md) | Thrown when the Revit user cancelled this operation. Thrown when the Revit user tried to switch the active view, close the active document or Revit application when responding to this mode. |
| [Autodesk.Revit.Exceptions..::..ForbiddenForDynamicUpdateException](c5b911f6-1e8f-2cd4-6965-286f41221fe0.md) | Thrown if this method is called during dynamic update. |
  
# See Also

[Selection Class](31b73d46-7d67-5dbb-4dad-80aa597c9afc.md)

[PickObjects Overload](e5a547a2-3cf5-7638-2daa-ea85b4d3de2d.md)

[Autodesk.Revit.UI.Selection Namespace](11785869-cc9e-03fc-97db-767a59af10a1.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)