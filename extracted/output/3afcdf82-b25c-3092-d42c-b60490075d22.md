

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
ItemFactoryBase..::..NewFamilyInstance Method (Face, XYZ, XYZ, FamilySymbol)  
[ItemFactoryBase Class](cba2c84a-22c0-e6e7-a99c-67656901853a.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Inserts a new instance of a family onto a face of an existing element, using a location, reference direction, and a type/symbol.

**Namespace:** [Autodesk.Revit.Creation](ded320da-058a-4edd-0418-0582389559a7.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)

# Syntax

C#  
---  
      
    
    public [FamilyInstance](0d2231f8-91e6-794f-92ae-16aad8014b27.md) NewFamilyInstance(
    	[Face](e32b3b1f-66fc-57cb-6e1c-aa81d1bf3e63.md) face,
    	[XYZ](c2fd995c-95c0-58fb-f5de-f3246cbc5600.md) location,
    	[XYZ](c2fd995c-95c0-58fb-f5de-f3246cbc5600.md) referenceDirection,
    	[FamilySymbol](a1acaed0-6a62-4c1d-94f5-4e27ce0923d3.md) symbol
    )  
  
Visual Basic  
---  
      
    
    Public Function NewFamilyInstance ( _
    	face As [Face](e32b3b1f-66fc-57cb-6e1c-aa81d1bf3e63.md), _
    	location As [XYZ](c2fd995c-95c0-58fb-f5de-f3246cbc5600.md), _
    	referenceDirection As [XYZ](c2fd995c-95c0-58fb-f5de-f3246cbc5600.md), _
    	symbol As [FamilySymbol](a1acaed0-6a62-4c1d-94f5-4e27ce0923d3.md) _
    ) As [FamilyInstance](0d2231f8-91e6-794f-92ae-16aad8014b27.md)  
  
Visual C++  
---  
      
    
    public:
    [FamilyInstance](0d2231f8-91e6-794f-92ae-16aad8014b27.md)^ NewFamilyInstance(
    	[Face](e32b3b1f-66fc-57cb-6e1c-aa81d1bf3e63.md)^ face, 
    	[XYZ](c2fd995c-95c0-58fb-f5de-f3246cbc5600.md)^ location, 
    	[XYZ](c2fd995c-95c0-58fb-f5de-f3246cbc5600.md)^ referenceDirection, 
    	[FamilySymbol](a1acaed0-6a62-4c1d-94f5-4e27ce0923d3.md)^ symbol
    )  
  
#### Parameters

face
    Type: [Autodesk.Revit.DB..::..Face](e32b3b1f-66fc-57cb-6e1c-aa81d1bf3e63.md)A face of a geometry object.

location
    Type: [Autodesk.Revit.DB..::..XYZ](c2fd995c-95c0-58fb-f5de-f3246cbc5600.md)Point on the face where the instance is to be placed.

referenceDirection
    Type: [Autodesk.Revit.DB..::..XYZ](c2fd995c-95c0-58fb-f5de-f3246cbc5600.md)A vector that defines the direction of the family instance. Note that this direction defines the rotation of the instance on the face, and thus cannot be parallel to the face normal.

symbol
    Type: [Autodesk.Revit.DB..::..FamilySymbol](a1acaed0-6a62-4c1d-94f5-4e27ce0923d3.md)A FamilySymbol object that represents the type of the instance that is to be inserted. Note that this symbol must represent a family whose [FamilyPlacementType](7fcd2fda-21c3-9b9b-8ef3-ae2e53e02a05.md) is WorkPlaneBased.

#### Return Value

An instance of the new object if creation was successful, otherwise nullNothingnullptra null reference (Nothing in Visual Basic).

# Remarks

Use this method to insert one family instance on a face of another element, using a point on the face and a vector to define the position and direction of the new symbol. 

The type/symbol that is used must be loaded into the document before this method is called. Families and their symbols can be loaded using the Document.LoadFamily or Document.LoadFamilySymbol methods.

The host object must support insertion of instances, otherwise this method will fail. If the instances fails to be created an exception may be thrown.

Some Families, such as Beams, have more than one endpoint and are inserted in the same manner as single point instances. Once inserted, these linear family instances can have their endpoints changed by using the instance's Element.Location property.

Note: if the created family instance includes nested instances, the API framework will automatically regenerate the document during this method call.

# Examples

CopyC#
    
    
    void CreateLightFixtureOnWall(Autodesk.Revit.DB.Document document, Wall wall)
    {
        FilteredElementCollector collector = new FilteredElementCollector(document);
        collector.OfClass(typeof(FamilySymbol)).OfCategory(BuiltInCategory.OST_LightingFixtures);
        FamilySymbol symbol = collector.FirstElement() as FamilySymbol;
    
        // The only way to get a Face to use with this NewFamilyInstance overload
        // is from Element.Geometry with ComputeReferences turned on
        Face face = null;
        Options geomOptions = new Options();
        geomOptions.ComputeReferences = true;
        GeometryElement wallGeom = wall.get_Geometry(geomOptions);
        foreach (GeometryObject geomObj in wallGeom)
        {
            Solid geomSolid = geomObj as Solid;
            if (null != geomSolid)
            {
                foreach (Face geomFace in geomSolid.Faces)
                {
                    face = geomFace;
                    break;
                }
                break;
            }
        }
    
        // Get the center of the wall 
        BoundingBoxUV bboxUV = face.GetBoundingBox();
        UV center = (bboxUV.Max + bboxUV.Min) / 2.0;
        XYZ location = face.Evaluate(center);
        XYZ normal = face.ComputeNormal(center);
        XYZ refDir = normal.CrossProduct(XYZ.BasisZ);
    
        FamilyInstance instance = document.Create.NewFamilyInstance(face, location, refDir, symbol);         
    }

CopyVB.NET
    
    
    Private Sub CreateLightFixtureOnWall(document As Autodesk.Revit.DB.Document, wall As Wall)
        Dim collector As New FilteredElementCollector(document)
        collector.OfClass(GetType(FamilySymbol)).OfCategory(BuiltInCategory.OST_LightingFixtures)
        Dim symbol As FamilySymbol = TryCast(collector.FirstElement(), FamilySymbol)
    
        ' The only way to get a Face to use with this NewFamilyInstance overload
        ' is from Element.Geometry with ComputeReferences turned on
        Dim face As Face = Nothing
        Dim geomOptions As New Options()
        geomOptions.ComputeReferences = True
        Dim wallGeom As GeometryElement = wall.Geometry(geomOptions)
        For Each geomObj As GeometryObject In wallGeom
            Dim geomSolid As Solid = TryCast(geomObj, Solid)
            If geomSolid IsNot Nothing Then
                For Each geomFace As Face In geomSolid.Faces
                    face = geomFace
                    Exit For
                Next
                Exit For
            End If
        Next
    
        ' Get the center of the wall 
        Dim bboxUV As BoundingBoxUV = face.GetBoundingBox()
        Dim center As UV = (bboxUV.Max + bboxUV.Min) / 2.0
        Dim location As XYZ = face.Evaluate(center)
        Dim normal As XYZ = face.ComputeNormal(center)
        Dim refDir As XYZ = normal.CrossProduct(XYZ.BasisZ)
    
        Dim instance As FamilyInstance = document.Create.NewFamilyInstance(face, location, refDir, symbol)
    End Sub

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | Thrown when a non-optional argument was null. |
| [Autodesk.Revit.Exceptions..::..ArgumentException](2e6e4206-97a8-dd4b-df5d-4269f4bb6088.md) | Thrown when the function cannot get the Reference from the face, or, when the Family cannot be placed as line-based on an input face reference, because its FamilyPlacementType is not WorkPlaneBased |
| [Autodesk.Revit.Exceptions..::..ArgumentsInconsistentException](05972c68-fa6d-3a83-d720-ad84fbc4780f.md) | Thrown when reference direction is parallel to face normal at insertion point. |
| [Autodesk.Revit.Exceptions..::..InvalidOperationException](9e715f03-3884-e539-4dd6-8d7545733adc.md) | Thrown when Revit is unable to place the family instance. |
| [Autodesk.Revit.Exceptions..::..ArgumentException](2e6e4206-97a8-dd4b-df5d-4269f4bb6088.md) | Thrown if The symbol is not active. |
  
# See Also

[ItemFactoryBase Class](cba2c84a-22c0-e6e7-a99c-67656901853a.md)

[NewFamilyInstance Overload](451ee414-cea0-e9bd-227b-c73bc93507dd.md)

[Autodesk.Revit.Creation Namespace](ded320da-058a-4edd-0418-0582389559a7.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)