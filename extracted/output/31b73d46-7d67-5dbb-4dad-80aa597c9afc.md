

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
Selection Class  
[Members](8eccaa93-cc99-fd37-15ad-24d201985d9b.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Contains the current user selection of elements within the project. 

**Namespace:** [Autodesk.Revit.UI.Selection](11785869-cc9e-03fc-97db-767a59af10a1.md)**Assembly:** RevitAPIUI (in RevitAPIUI.dll) Version: 24.0.0.0 (24.0.0.0)

# Syntax

C#  
---  
      
    
    public class Selection : IDisposable  
  
Visual Basic  
---  
      
    
    Public Class Selection _
    	Implements IDisposable  
  
Visual C++  
---  
      
    
    public ref class Selection : IDisposable  
  
# Remarks

The Selection object is used to retrieve the current user selected elements when an external API command is executed. 

# Examples

CopyC#
    
    
    [Autodesk.Revit.Attributes.Transaction(Autodesk.Revit.Attributes.TransactionMode.ReadOnly)]
    public class Document_Selection : IExternalCommand
    {
        public Autodesk.Revit.UI.Result Execute(ExternalCommandData commandData,
            ref string message, ElementSet elements)
        {
            try
            {
                // Select some elements in Revit before invoking this command
    
                // Get the handle of current document.
                UIDocument uidoc = commandData.Application.ActiveUIDocument;
    
                // Get the element selection of current document.
                Selection selection = uidoc.Selection;
                ICollection<ElementId> selectedIds = uidoc.Selection.GetElementIds();
    
                if (0 == selectedIds.Count)
                {
                    // If no elements selected.
                    TaskDialog.Show("Revit","You haven't selected any elements.");
                }
                else
                {
                    String info = "Ids of selected elements in the document are: ";
                    foreach (ElementId id in selectedIds)
                    {
                       info += "\n\t" + id.ToString();
                    }
    
                    TaskDialog.Show("Revit",info);
                }
            }
            catch (Exception e)
            {
                message = e.Message;
                return Autodesk.Revit.UI.Result.Failed;
            }
    
            return Autodesk.Revit.UI.Result.Succeeded;
        }
        /// </ExampleMethod>
    }

CopyC#
    
    
    private void ChangeSelection(UIDocument uidoc)
    {
        // Get selected elements from current document.
        ICollection<ElementId> selectedIds = uidoc.Selection.GetElementIds();
    
        // Display current number of selected elements
        TaskDialog.Show("Revit", "Number of selected elements: " + selectedIds.Count.ToString());
    
        // Go through the selected items and filter out walls only.
        ICollection<ElementId> selectedWallIds = new List<ElementId>();
    
        foreach (ElementId id in selectedIds)
        {
            Element elements = uidoc.Document.GetElement(id);
            if (elements is Wall)
            {
                selectedWallIds.Add(id);
            }
        }
    
        // Set the created element set as current select element set.
        uidoc.Selection.SetElementIds(selectedWallIds);
    
        // Give the user some information.
        if (0 != selectedWallIds.Count)
        {
            TaskDialog.Show("Revit", selectedWallIds.Count.ToString() + " Walls are selected!");
        }
        else
        {
            TaskDialog.Show("Revit","No Walls have been selected!");
        }
    }

CopyVB.NET
    
    
    <Autodesk.Revit.Attributes.Transaction(Autodesk.Revit.Attributes.TransactionMode.[ReadOnly])> _
    Public Class Document_Selection
        Implements IExternalCommand
        Public Function Execute(commandData As ExternalCommandData, ByRef message As String, elements As ElementSet) As Autodesk.Revit.UI.Result Implements IExternalCommand.Execute
            Try
                ' Select some elements in Revit before invoking this command
    
    
                ' Get the handle of current document.
                Dim uidoc As UIDocument = commandData.Application.ActiveUIDocument
    
                ' Get the element selection of current document.
                Dim selection As Selection = uidoc.Selection
                Dim selectedIds As ICollection(Of ElementId) = uidoc.Selection.GetElementIds()
    
                If 0 = selectedIds.Count Then
                    ' If no elements selected.
                    TaskDialog.Show("Revit", "You haven't selected any elements.")
                Else
                    Dim info As [String] = "Ids of selected elements in the document are: "
                    For Each id As ElementId In selectedIds
                        info += vbLf & vbTab + id.ToString()
                    Next
    
                    TaskDialog.Show("Revit", info)
                End If
            Catch e As Exception
                message = e.Message
                Return Autodesk.Revit.UI.Result.Failed
            End Try
    
            Return Autodesk.Revit.UI.Result.Succeeded
        End Function
        ' </ExampleMethod>
    End Class

CopyVB.NET
    
    
    Private Sub ChangeSelection(uidoc As UIDocument)
        ' Get selected elements from current document.
        Dim selectedIds As ICollection(Of ElementId) = uidoc.Selection.GetElementIds()
    
        ' Display current number of selected elements
        TaskDialog.Show("Revit", "Number of selected elements: " + selectedIds.Count.ToString())
    
        ' Go through the selected items and filter out walls only.
        Dim selectedWallIds As ICollection(Of ElementId) = New List(Of ElementId)()
    
        For Each id As ElementId In selectedIds
            Dim elements As Element = uidoc.Document.GetElement(id)
            If TypeOf elements Is Wall Then
                selectedWallIds.Add(id)
            End If
        Next
    
        ' Set the created element set as current select element set.
        uidoc.Selection.SetElementIds(selectedWallIds)
    
        ' Give the user some information.
        If 0 <> selectedWallIds.Count Then
            TaskDialog.Show("Revit", selectedWallIds.Count.ToString() + " Walls are selected!")
        Else
            TaskDialog.Show("Revit", "No Walls have been selected!")
        End If
    End Sub

# Inheritance Hierarchy

System..::..Object Autodesk.Revit.UI.Selection..::..Selection

# See Also

[Selection Members](8eccaa93-cc99-fd37-15ad-24d201985d9b.md)

[Autodesk.Revit.UI.Selection Namespace](11785869-cc9e-03fc-97db-767a59af10a1.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)