

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
ExternalServiceRegistry..::..ExecuteService Method (Guid, Document, IExternalData)  
[ExternalServiceRegistry Class](fa14442f-3d47-2c21-467c-6d19e4cc0d9e.md) See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Execute the service for the given document. 

**Namespace:** [Autodesk.Revit.DB.ExternalService](a88f2d1d-c02f-a901-9543-44e4b5dd5fc9.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2013 

# Syntax

C#  
---  
      
    
    public static [ExternalServiceResult](63c83d88-92c7-5283-8b39-efb0baeedcd8.md) ExecuteService(
    	Guid executionKey,
    	[Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md) document,
    	[IExternalData](d4f0854f-3b67-c60e-1696-8cffbaba065a.md) data
    )  
  
Visual Basic  
---  
      
    
    Public Shared Function ExecuteService ( _
    	executionKey As Guid, _
    	document As [Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md), _
    	data As [IExternalData](d4f0854f-3b67-c60e-1696-8cffbaba065a.md) _
    ) As [ExternalServiceResult](63c83d88-92c7-5283-8b39-efb0baeedcd8.md)  
  
Visual C++  
---  
      
    
    public:
    static [ExternalServiceResult](63c83d88-92c7-5283-8b39-efb0baeedcd8.md) ExecuteService(
    	Guid executionKey, 
    	[Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md)^ document, 
    	[IExternalData](d4f0854f-3b67-c60e-1696-8cffbaba065a.md)^ data
    )  
  
#### Parameters

executionKey
    Type: System..::..Guid Access key of the service to be executed. The key is not the same as the service's Id. It is the value that was returned to the caller who registered the service. 

document
    Type: [Autodesk.Revit.DB..::..Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md) The document for which the service is going to be executed. 

data
    Type: [Autodesk.Revit.DB.ExternalService..::..IExternalData](d4f0854f-3b67-c60e-1696-8cffbaba065a.md) The associated data. The type must be of the class defined by the service. 

#### Return Value

The result of executing the external service. 

# Remarks

Execution of a service should be invoked only by the application that registered the service. The execution will use the active server (or servers in the case of a multi-server service) currently set for the given document. If there is no server specifically set for the document the current application-wide server (or servers) will be applied. 

Please note that recordable services may only be executed in a document that is currently modifiable. An exception will be thrown if it isn't so. This requirement does not apply to non-recordable services. 

This method is primarily intended for executing of recordable services, for it is assumed that any changes made to the model during the service's execution are likely tied with the service's currently active servers. If the service was registered as non-recordable, changes to the model may still be made, but the framework does not assume any explicit or implicit correlations between the document changes and servers that caused them, therefore it is not recorded which server did what. This fact is very important, particularly in work-sharing environment. If it may happen that different local users can have different servers installed and available, it is imperative for a non-serialized service that its servers are completely compatible with (or indifferent to) document modifications made by other servers of the same service. The responsibility for complying with this assumption is entirely on the service's provider. 

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentException](2e6e4206-97a8-dd4b-df5d-4269f4bb6088.md) | The execution key is either invalid or of a service that is not registered. To execute a service, the key returned by RegisterService method must be used. -or- The execution key is of a service that is already being executed. |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | A non-optional argument was null |
| [Autodesk.Revit.Exceptions..::..InvalidOperationException](9e715f03-3884-e539-4dd6-8d7545733adc.md) | Executing a recordable service in a document that is not modifiable. |
  
# See Also

[ExternalServiceRegistry Class](fa14442f-3d47-2c21-467c-6d19e4cc0d9e.md)

[ExecuteService Overload](441ae935-fa59-aa1e-23ba-57e334974c7f.md)

[Autodesk.Revit.DB.ExternalService Namespace](a88f2d1d-c02f-a901-9543-44e4b5dd5fc9.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)