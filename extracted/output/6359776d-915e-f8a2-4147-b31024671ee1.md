

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
FilteredElementCollector Constructor (Document, ElementId)  
[FilteredElementCollector Class](263cf06b-98be-6f91-c4da-fb47d01688f3.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Constructs a new FilteredElementCollector that will search and filter the visible elements in a view. 

**Namespace:** [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2011 

# Syntax

C#  
---  
      
    
    public FilteredElementCollector(
    	[Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md) document,
    	[ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md) viewId
    )  
  
Visual Basic  
---  
      
    
    Public Sub New ( _
    	document As [Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md), _
    	viewId As [ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md) _
    )  
  
Visual C++  
---  
      
    
    public:
    FilteredElementCollector(
    	[Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md)^ document, 
    	[ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md)^ viewId
    )  
  
#### Parameters

document
    Type: [Autodesk.Revit.DB..::..Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md) The document that owns the view. 

viewId
    Type: [Autodesk.Revit.DB..::..ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md) The view id. 

# Remarks

Elements that will be passed by the collector have graphics that may be visible in the input view. Some elements may still be hidden because they are obscured by other elements.

For elements which are outside of a crop region, they may still be passed by the collector because Revit relies on later processing to eliminate the elements hidden by the crop. This effect may more easily occur for non-rectangular crop regions, but may also happen even for rectangular crops. You can compare the boundary of the region with the element's boundary if more precise results are required.

Accessing these visible elements may require Revit to rebuild the geometry of the view. The first time your code constructs a collector for a given view, or the first time your code constructs a collector for a view whose display settings have just been changed, you may experience a significant performance degradation.

# Examples

CopyC#
    
    
    private void CountElements(UIDocument uiDoc)
    {
        StringBuilder message = new StringBuilder();
        FilteredElementCollector viewCollector = 
            new FilteredElementCollector(uiDoc.Document, uiDoc.ActiveView.Id);
        viewCollector.OfCategory(BuiltInCategory.OST_Walls);
        message.AppendLine("Wall category elements within active View: "
           + viewCollector.ToElementIds().Count);
    
        FilteredElementCollector docCollector = new FilteredElementCollector(uiDoc.Document);
        docCollector.OfCategory(BuiltInCategory.OST_Walls);
        message.AppendLine("Wall category elements within document: "
           + docCollector.ToElementIds().Count);
    
        TaskDialog.Show("Revit", message.ToString());
    }

CopyC#
    
    
    public static void GetScheduleContents(ViewSchedule viewSchedule)
    {
        // Collect types displayed in the schedule
        FilteredElementCollector typeCollector = new FilteredElementCollector(viewSchedule.Document, viewSchedule.Id);
        typeCollector.WhereElementIsElementType();
    
        int numberOfTypes = typeCollector.Count();
    
        // Collect instances displayed in the schedule
        FilteredElementCollector instCollector = new FilteredElementCollector(viewSchedule.Document, viewSchedule.Id);
        instCollector.WhereElementIsNotElementType();
    
        int numberOfInstances = instCollector.Count();
    
        TaskDialog.Show("Elements in schedule", String.Format("Types {0} instances {1}", numberOfTypes, numberOfInstances));
    }

CopyVB.NET
    
    
    Private Sub CountElements(uiDoc As UIDocument)
       Dim message As New StringBuilder()
       Dim viewCollector As New FilteredElementCollector(uiDoc.Document, uiDoc.ActiveView.Id)
       viewCollector.OfCategory(BuiltInCategory.OST_Walls)
       message.AppendLine("Wall category elements within active View: " + viewCollector.ToElementIds().Count)
    
       Dim docCollector As New FilteredElementCollector(uiDoc.Document)
       docCollector.OfCategory(BuiltInCategory.OST_Walls)
       message.AppendLine("Wall category elements within document: " + docCollector.ToElementIds().Count)
    
       TaskDialog.Show("Revit", message.ToString())
    End Sub

CopyVB.NET
    
    
    Public Shared Sub GetScheduleContents(viewSchedule As ViewSchedule)
        ' Collect types displayed in the schedule
        Dim typeCollector As New FilteredElementCollector(viewSchedule.Document, viewSchedule.Id)
        typeCollector.WhereElementIsElementType()
    
        Dim numberOfTypes As Integer = typeCollector.Count()
    
        ' Collect instances displayed in the schedule
        Dim instCollector As New FilteredElementCollector(viewSchedule.Document, viewSchedule.Id)
        instCollector.WhereElementIsNotElementType()
    
        Dim numberOfInstances As Integer = instCollector.Count()
    
        TaskDialog.Show("Elements in schedule", [String].Format("Types {0} instances {1}", numberOfTypes, numberOfInstances))
    End Sub

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentException](2e6e4206-97a8-dd4b-df5d-4269f4bb6088.md) | viewId is not a view. -or- viewId is not valid for element iteration, because it has no way of representing drawn elements. Many view templates will fail this check. |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | A non-optional argument was null |
  
# See Also

[FilteredElementCollector Class](263cf06b-98be-6f91-c4da-fb47d01688f3.md)

[FilteredElementCollector Overload](a9599101-043e-ddbc-f50a-8e55cd615daf.md)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)