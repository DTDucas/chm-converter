

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
WorksharingUtils Class  
[Members](653a0e7c-8e55-b715-b2a5-e71a416ecb14.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
A static class that contains utility functions related to worksharing. 

**Namespace:** [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2012 

# Syntax

C#  
---  
      
    
    public class WorksharingUtils : IDisposable  
  
Visual Basic  
---  
      
    
    Public Class WorksharingUtils _
    	Implements IDisposable  
  
Visual C++  
---  
      
    
    public ref class WorksharingUtils : IDisposable  
  
# Remarks

Return values from inquiries about the worksharing status of elements or worksets rely on local caching of information from the central model so it is possible that the information is out of date. Because of this, the return value is suitable for reporting to an interactive user (e.g. via a mechanism similar to Worksharing display mode), but cannot be considered a reliable indication of whether the element can be immediately edited by the application. To make an immediate attempt to edit elements, use [!:CheckoutElements()] and check the return status, then confirm if the elements are up to date.

In addition, information about the current user may not be reliable while Revit is in the middle of an editing transaction. For example, if you move an unowned wall from an unowned workset to a workset you own, then before you explicitly or Revit automatically checks out the wall for you, GetCheckoutStatus() might erroneously tell you CheckoutStatus.OwnedByCurrentUser because although the official (as seen in central and by other users) owner is no one, locally it looks like you already own it since it belongs to a workset you own. 

For operations that interact with central (as opposed to use only cached values), Revit might opportunistically refresh some editing permissions or check the status of editing requests. 

Some useful definitions to keep in mind follow: 

  * The owner of a workset: the user who has the Workset checked out; this could be nobody (the empty string). 
  * The borrower of an element: the user who has explicitly checked out ("borrowed") the Element; this could be nobody. 
  * The owner of an element: If element is borrowed (i.e. explicitly checked out), then the element's owner is the borrower, otherwise it is the owner or the workset containing the element. 



# Examples

CopyC#
    
    
    public void GetElementWorksharingInfo(Document doc, Element elem)
    {
        String message = String.Empty;
        message += "Element Id: " + elem.Id;
    
        // The workset the element belongs to
        WorksetId worksetId = elem.WorksetId;
        message += ("\nWorkset Id : " + worksetId.ToString());
    
        // Model Updates Status of the element
        ModelUpdatesStatus updateStatus = WorksharingUtils.GetModelUpdatesStatus(doc, elem.Id);
        message += ("\nUpdate status : " + updateStatus.ToString());
    
        // Checkout Status of the element
        CheckoutStatus checkoutStatus = WorksharingUtils.GetCheckoutStatus(doc, elem.Id);
        message += ("\nCheckout status : " + checkoutStatus.ToString());
    
        // Getting WorksharingTooltipInfo of a given element Id
        WorksharingTooltipInfo tooltipInfo = WorksharingUtils.GetWorksharingTooltipInfo(doc, elem.Id);
        message += ("\nCreator : " + tooltipInfo.Creator);
        message += ("\nCurrent Owner : " + tooltipInfo.Owner);
        message += ("\nLast Changed by : " + tooltipInfo.LastChangedBy);
    
        Autodesk.Revit.UI.TaskDialog.Show("GetElementWorksharingInfo", message);
    }

CopyVB.NET
    
    
    Public Sub GetElementWorksharingInfo(doc As Document, elem As Element)
        Dim message As [String] = [String].Empty
        message += "Element Id: " + elem.Id.ToString
    
        ' The workset the element belongs to
        Dim worksetId As WorksetId = elem.WorksetId
        message += (vbLf & "Workset Id : " + worksetId.ToString())
    
        ' Model Updates Status of the element
        Dim updateStatus As ModelUpdatesStatus = WorksharingUtils.GetModelUpdatesStatus(doc, elem.Id)
        message += (vbLf & "Update status : " + updateStatus.ToString())
    
        ' Checkout Status of the element
        Dim checkoutStatus As CheckoutStatus = WorksharingUtils.GetCheckoutStatus(doc, elem.Id)
        message += (vbLf & "Checkout status : " + checkoutStatus.ToString())
    
        ' Getting WorksharingTooltipInfo of a given element Id
        Dim tooltipInfo As WorksharingTooltipInfo = WorksharingUtils.GetWorksharingTooltipInfo(doc, elem.Id)
        message += (vbLf & "Creator : " + tooltipInfo.Creator)
        message += (vbLf & "Current Owner : " + tooltipInfo.Owner)
        message += (vbLf & "Last Changed by : " + tooltipInfo.LastChangedBy)
    
        Autodesk.Revit.UI.TaskDialog.Show("GetElementWorksharingInfo", message)
    End Sub

# Inheritance Hierarchy

System..::..Object Autodesk.Revit.DB..::..WorksharingUtils

# See Also

[WorksharingUtils Members](653a0e7c-8e55-b715-b2a5-e71a416ecb14.md)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)