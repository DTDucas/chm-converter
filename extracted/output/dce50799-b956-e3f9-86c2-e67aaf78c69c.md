

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
AssetProperty..::..AddCopyAsConnectedAsset Method   
[AssetProperty Class](7be89499-d011-ab43-4715-0ee6f9335970.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Makes a copy of the asset and connects it to this property. 

**Namespace:** [Autodesk.Revit.DB.Visual](f5a10581-6ac2-be19-0e32-f87d05bc8b83.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2018.1 

# Syntax

C#  
---  
      
    
    public void AddCopyAsConnectedAsset(
    	[Asset](598e104b-b6ec-9ebe-7a93-ec96b8cbeba9.md) pRenderingAsset
    )  
  
Visual Basic  
---  
      
    
    Public Sub AddCopyAsConnectedAsset ( _
    	pRenderingAsset As [Asset](598e104b-b6ec-9ebe-7a93-ec96b8cbeba9.md) _
    )  
  
Visual C++  
---  
      
    
    public:
    void AddCopyAsConnectedAsset(
    	[Asset](598e104b-b6ec-9ebe-7a93-ec96b8cbeba9.md)^ pRenderingAsset
    )  
  
#### Parameters

pRenderingAsset
    Type: [Autodesk.Revit.DB.Visual..::..Asset](598e104b-b6ec-9ebe-7a93-ec96b8cbeba9.md) The asset to duplicate and associate with this property as a connected asset. 

# Examples

CopyC#
    
    
    public void CopyAndAddConnectedAsset(Material sourceMaterial, Material targetMaterial)
    {
       Document doc = targetMaterial.Document;
    
       // Get the appearance asset of the source material
    
       ElementId otherAppearanceAssetId = sourceMaterial.AppearanceAssetId;
    
       AppearanceAssetElement otherAssetElem = doc.GetElement(otherAppearanceAssetId) as AppearanceAssetElement;
    
       Asset otherAsset = otherAssetElem.GetRenderingAsset();
    
       // Get the connected asset of the source material appearance asset (that contains the bitmap)
    
       AssetProperty otherGenericDiffuseProperty = otherAsset.FindByName(Generic.GenericDiffuse);
    
       Asset otherGenericDiffuseConnectedAsset = otherGenericDiffuseProperty.GetSingleConnectedAsset();
    
       using (Transaction t = new Transaction(doc, "Change a connected asset by a copy"))
       {
          t.Start();
    
          using (AppearanceAssetEditScope editScope = new AppearanceAssetEditScope(doc))
          {
             ElementId appearanceAssetId = targetMaterial.AppearanceAssetId;
    
             Asset editableAsset = editScope.Start(appearanceAssetId);   // returns an editable copy of the appearance asset                   
    
             AssetProperty genericDiffuseProperty = editableAsset.FindByName(Generic.GenericDiffuse);
    
             // Find the connected asset (with a shortcut to get the only one)
    
             Asset genericDiffuseConnectedAsset = genericDiffuseProperty.GetSingleConnectedAsset();
    
             if (genericDiffuseConnectedAsset == null)
             {
                // Target material has only a color for �GenericDiffuse�
                // This will assign a bitmap to it instead
                // by making a copy of the asset and use it as connected asset
                genericDiffuseProperty.AddCopyAsConnectedAsset(otherGenericDiffuseConnectedAsset);
             }       
    
             editScope.Commit(true);
          }
    
          t.Commit();
       }
    }

CopyVB.NET
    
    
    Public Sub CopyAndAddConnectedAsset(sourceMaterial As Material, targetMaterial As Material)
        Dim doc As Document = targetMaterial.Document
    
        ' Get the appearance asset of the source material
    
    
        Dim otherAppearanceAssetId As ElementId = sourceMaterial.AppearanceAssetId
    
        Dim otherAssetElem As AppearanceAssetElement = TryCast(doc.GetElement(otherAppearanceAssetId), AppearanceAssetElement)
    
        Dim otherAsset As Asset = otherAssetElem.GetRenderingAsset()
    
     ' Get the connected asset of the source material appearance asset (that contains the bitmap)
    
    
     Dim otherGenericDiffuseProperty As AssetProperty = otherAsset.FindByName(Generic.GenericDiffuse)
    
     Dim otherGenericDiffuseConnectedAsset As Asset = otherGenericDiffuseProperty.GetSingleConnectedAsset()
    
        Using t As New Transaction(doc, "Change a connected asset by a copy")
            t.Start()
    
            Using editScope As New AppearanceAssetEditScope(doc)
                Dim appearanceAssetId As ElementId = targetMaterial.AppearanceAssetId
    
                Dim editableAsset As Asset = editScope.Start(appearanceAssetId)
           ' returns an editable copy of the appearance asset                   
           Dim genericDiffuseProperty As AssetProperty = editableAsset.FindByName(Generic.GenericDiffuse)
    
           ' Find the connected asset (with a shortcut to get the only one)
    
    
           Dim genericDiffuseConnectedAsset As Asset = genericDiffuseProperty.GetSingleConnectedAsset()
    
                If genericDiffuseConnectedAsset Is Nothing Then
                    ' Target material has only a color for “GenericDiffuse”
                    ' This will assign a bitmap to it instead
                    ' by making a copy of the asset and use it as connected asset
                    genericDiffuseProperty.AddCopyAsConnectedAsset(otherGenericDiffuseConnectedAsset)
                End If
    
                editScope.Commit(True)
            End Using
    
            t.Commit()
        End Using
    End Sub

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | A non-optional argument was null |
| [Autodesk.Revit.Exceptions..::..InvalidOperationException](9e715f03-3884-e539-4dd6-8d7545733adc.md) | The asset property is not editable. -or- Cannot check validity for a property not being edited in AppearanceAssetEditScope. -or- Asset property is already connected to one asset. |
  
# See Also

[AssetProperty Class](7be89499-d011-ab43-4715-0ee6f9335970.md)

[Autodesk.Revit.DB.Visual Namespace](f5a10581-6ac2-be19-0e32-f87d05bc8b83.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)