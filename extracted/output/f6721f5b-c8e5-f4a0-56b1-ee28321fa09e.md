

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
ExternalServiceRegistry..::..RegisterService Method (ISingleServerService, Guid, ExternalServiceOptions)  
[ExternalServiceRegistry Class](fa14442f-3d47-2c21-467c-6d19e4cc0d9e.md) See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
A method to register a mandatory, single-server service. 

**Namespace:** [Autodesk.Revit.DB.ExternalService](a88f2d1d-c02f-a901-9543-44e4b5dd5fc9.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2014 

# Syntax

C#  
---  
      
    
    public static Guid RegisterService(
    	[ISingleServerService](ae967a42-6490-07ed-7976-71d324d250c4.md) service,
    	Guid defaultServerId,
    	[ExternalServiceOptions](80467d42-3f13-de3e-cd06-bf3b43afefe0.md) options
    )  
  
Visual Basic  
---  
      
    
    Public Shared Function RegisterService ( _
    	service As [ISingleServerService](ae967a42-6490-07ed-7976-71d324d250c4.md), _
    	defaultServerId As Guid, _
    	options As [ExternalServiceOptions](80467d42-3f13-de3e-cd06-bf3b43afefe0.md) _
    ) As Guid  
  
Visual C++  
---  
      
    
    public:
    static Guid RegisterService(
    	[ISingleServerService](ae967a42-6490-07ed-7976-71d324d250c4.md)^ service, 
    	Guid defaultServerId, 
    	[ExternalServiceOptions](80467d42-3f13-de3e-cd06-bf3b43afefe0.md)^ options
    )  
  
#### Parameters

service
    Type: [Autodesk.Revit.DB.ExternalService..::..ISingleServerService](ae967a42-6490-07ed-7976-71d324d250c4.md) An instance of the external service class that implements ISingleServerService interface. 

defaultServerId
    Type: System..::..Guid Id of the server that will become the service's default server (once the server is registered). 

options
    Type: [Autodesk.Revit.DB.ExternalService..::..ExternalServiceOptions](80467d42-3f13-de3e-cd06-bf3b43afefe0.md) Optional settings to control the service's behavior. 

#### Return Value

An access key to the service. The key is needed to execute the service. 

# Remarks

Each service can only be registered once. Revit checks the Id of every service getting registered and throws an exception upon an attempt to register a service with an Id that already exists. 

Services need to be registered before Revit ends its initialization. For external applications that means they have to register their services during OnStartup. This will give servers which need to register to services a chance to do so during the ApplicationInitialized event, which is raised after a successfully processing OnStartup routines. 

A service can be registered as either recordable or non-recordable. It is expected that a service that is once registered as recordable will always be registered as recordable. Failure to comply with this policy may lead to data loss in some documents when they are opened in a Revit session with the service currently registered as non-recordable. 

A service is supposed to be executed only by the application that registered it. To enforce this requirement, the registering method return an execution key (a Guid) that is required as an argument to ExecuteService methods. If the owner of a service allows executing it by anyone, it needs to register it as a public service (via the option argument). Once registered as public, The access key of the service can be obtained by any application, thus it can also be executed by any application. By default, a service is registered as private. 

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentException](2e6e4206-97a8-dd4b-df5d-4269f4bb6088.md) | The given service is not a valid implementation of ISingleServerService. -or- The given service does not return valid values from the interface methods. At least one of the Name, VendorId, Description, and ServiceId is either empty or invalid. -or- A service with this Id is either invalid or not unique. -or- The given Id is not a valid GUID value. -or- A mandatory service should support activation. |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | A non-optional argument was null |
| [Autodesk.Revit.Exceptions..::..InvalidOperationException](9e715f03-3884-e539-4dd6-8d7545733adc.md) | Service cannot be registered because the registry of services has been already closed. All external services must be registered before the ApplicationInitialized event is raised. |
  
# See Also

[ExternalServiceRegistry Class](fa14442f-3d47-2c21-467c-6d19e4cc0d9e.md)

[RegisterService Overload](6d690a5d-62c5-958c-842e-620a49421c1c.md)

[Autodesk.Revit.DB.ExternalService Namespace](a88f2d1d-c02f-a901-9543-44e4b5dd5fc9.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)