

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
ProjectLocation..::..GetProjectPosition Method   
[ProjectLocation Class](1249d5fa-74f3-cf64-0a63-7ab370b67a5c.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Gets the coordinates of a point in the ProjectLocation's coordinate system. 

**Namespace:** [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)

# Syntax

C#  
---  
      
    
    public [ProjectPosition](249111cc-c1f3-d3e1-e7bf-dc791327fd4c.md) GetProjectPosition(
    	[XYZ](c2fd995c-95c0-58fb-f5de-f3246cbc5600.md) point
    )  
  
Visual Basic  
---  
      
    
    Public Function GetProjectPosition ( _
    	point As [XYZ](c2fd995c-95c0-58fb-f5de-f3246cbc5600.md) _
    ) As [ProjectPosition](249111cc-c1f3-d3e1-e7bf-dc791327fd4c.md)  
  
Visual C++  
---  
      
    
    public:
    [ProjectPosition](249111cc-c1f3-d3e1-e7bf-dc791327fd4c.md)^ GetProjectPosition(
    	[XYZ](c2fd995c-95c0-58fb-f5de-f3246cbc5600.md)^ point
    )  
  
#### Parameters

point
    Type: [Autodesk.Revit.DB..::..XYZ](c2fd995c-95c0-58fb-f5de-f3246cbc5600.md)

# Remarks

When getting this value, the North/South, East/West, and Elevation values report the coordinates of the point similar to the Revit command "Report Shared Coordinates". To get the values of the transformations applied by this project location, pass XYZ.Zero.

If the project has acquired shared coordinates from a linked model, the shared coordinate transformation will be reflected in the coordinates of the transformed point returned by this property.

# Examples

CopyC#
    
    
    //get and set the value of the projectlocation
    public ProjectLocation GetProjectLocation(Autodesk.Revit.DB.Document document)
    {
        ProjectLocation currentLocation = document.ActiveProjectLocation;
    
        //get the project position
        XYZ origin = new XYZ(0, 0, 0);
    
        const double angleRatio = Math.PI / 180;   // angle conversion factor
    
        ProjectPosition projectPosition = currentLocation.GetProjectPosition(origin);
        //Angle from True North
        double angle = 30.0 * angleRatio;   // convert degrees to radian
        double eastWest = 30.0;     //East to West offset
        double northSouth = 23.32;   //North to South offset
        double elevation = 22.14;    //Elevation above ground level
    
        //create a new project position
        ProjectPosition newPosition =
          document.Application.Create.NewProjectPosition(eastWest, northSouth, elevation, angle);
    
        if (null != newPosition)
        {
            //set the value of the project position
            currentLocation.SetProjectPosition(origin, newPosition);
        }
    
        return currentLocation;
    }

CopyVB.NET
    
    
    'get and set the value of the projectlocation
    Public Function GetProjectLocation(document As Autodesk.Revit.DB.Document) As ProjectLocation
        Dim currentLocation As ProjectLocation = document.ActiveProjectLocation
    
        'get the project position
        Dim origin As New XYZ(0, 0, 0)
    
        Const angleRatio As Double = Math.PI / 180
        ' angle conversion factor
        Dim projectPosition As ProjectPosition = currentLocation.GetProjectPosition(origin)
        'Angle from True North
        Dim angle As Double = 30.0 * angleRatio
        ' convert degrees to radian
        Dim eastWest As Double = 30.0
        'East to West offset
        Dim northSouth As Double = 23.32
        'North to South offset
        Dim elevation As Double = 22.14
        'Elevation above ground level
        'create a new project position
        Dim newPosition As ProjectPosition = document.Application.Create.NewProjectPosition(eastWest, northSouth, elevation, angle)
    
        If newPosition IsNot Nothing Then
            'set the value of the project position
            currentLocation.SetProjectPosition(origin, newPosition)
        End If
    
        Return currentLocation
    End Function

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | A non-optional argument was null |
| [Autodesk.Revit.Exceptions..::..InvalidOperationException](9e715f03-3884-e539-4dd6-8d7545733adc.md) | Unable to use the project position's transform to calculate the point. |
  
# See Also

[ProjectLocation Class](1249d5fa-74f3-cf64-0a63-7ab370b67a5c.md)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)