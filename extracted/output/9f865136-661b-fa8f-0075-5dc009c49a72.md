

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
ImportInstance..::..Create Method (Document, View, ExternalResourceReference, ImportOptions3DM, LinkLoadResult%)  
[ImportInstance Class](85b534b8-dd6c-bc13-7c46-c803c83481e4.md) See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Creates a new instance of 3DM link type from an external resource reference and loads the linked file. 

**Namespace:** [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2022 

# Syntax

C#  
---  
      
    
    public static [ImportInstance](85b534b8-dd6c-bc13-7c46-c803c83481e4.md) Create(
    	[Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md) document,
    	[View](fb92a4e7-f3a7-ef14-e631-342179b18de9.md) DBView,
    	[ExternalResourceReference](ffad9c15-8fc9-fbfd-f328-101533f4cf74.md) resourceReference,
    	[ImportOptions3DM](72310605-e939-bc8c-c790-642da4cc02cb.md) options,
    	out [LinkLoadResult](f846bfb0-b047-9332-567f-75ae880d8359.md) linkLoadResult
    )  
  
Visual Basic  
---  
      
    
    Public Shared Function Create ( _
    	document As [Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md), _
    	DBView As [View](fb92a4e7-f3a7-ef14-e631-342179b18de9.md), _
    	resourceReference As [ExternalResourceReference](ffad9c15-8fc9-fbfd-f328-101533f4cf74.md), _
    	options As [ImportOptions3DM](72310605-e939-bc8c-c790-642da4cc02cb.md), _
    	<OutAttribute> ByRef linkLoadResult As [LinkLoadResult](f846bfb0-b047-9332-567f-75ae880d8359.md) _
    ) As [ImportInstance](85b534b8-dd6c-bc13-7c46-c803c83481e4.md)  
  
Visual C++  
---  
      
    
    public:
    static [ImportInstance](85b534b8-dd6c-bc13-7c46-c803c83481e4.md)^ Create(
    	[Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md)^ document, 
    	[View](fb92a4e7-f3a7-ef14-e631-342179b18de9.md)^ DBView, 
    	[ExternalResourceReference](ffad9c15-8fc9-fbfd-f328-101533f4cf74.md)^ resourceReference, 
    	[ImportOptions3DM](72310605-e939-bc8c-c790-642da4cc02cb.md)^ options, 
    	[OutAttribute] [LinkLoadResult](f846bfb0-b047-9332-567f-75ae880d8359.md)^% linkLoadResult
    )  
  
#### Parameters

document
    Type: [Autodesk.Revit.DB..::..Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md) The document in which to create the 3DM link. 

DBView
    Type: [Autodesk.Revit.DB..::..View](fb92a4e7-f3a7-ef14-e631-342179b18de9.md) The view into which the 3DM link will be created. 

resourceReference
    Type: [Autodesk.Revit.DB..::..ExternalResourceReference](ffad9c15-8fc9-fbfd-f328-101533f4cf74.md) The external resource reference describing the source of the 3DM link. 

options
    Type: [Autodesk.Revit.DB..::..ImportOptions3DM](72310605-e939-bc8c-c790-642da4cc02cb.md) Various import options applicable to the 3DM format. If nullNothingnullptra null reference (Nothing in Visual Basic), all options will be set to their respective default values. 

linkLoadResult
    Type: [Autodesk.Revit.DB..::..LinkLoadResult](f846bfb0-b047-9332-567f-75ae880d8359.md)% An object containing the results of creating and loading the 3DM link. It contains the ElementId of the new created 3DM link type. 

#### Return Value

The new instance of 3DM link type created. 

# Remarks

This function creates a new 3DM link type as well as a new instance of this 3DM link type. The new instance of 3DM link type is returned by this function and the element id of the new 3DM link type is contained in the LinkLoadResult. 

If the given external resource reference of the 3DM link is already used by an existing 3DM link type, a new instance of this existing 3DM link type is created and returned. The element id of the existing 3DM link type is contained in the LinkLoadResult.

This function regenerates the input document.

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentException](2e6e4206-97a8-dd4b-df5d-4269f4bb6088.md) | document is not a project document. -or- document is in an edit mode. -or- Import is temporarily disabled. -or- The view is not printable. -or- ThisViewOnly cannot be true when importing a DWG | DGN drawing into a 3D view. -or- One or more strings describing layer selection is invalid or empty. -or- The scale is not valid as a CustomScale for use during import. -or- The server referenced by the ExternalResourceReference does not exist or does not implement IExternalResourceServer. -or- The server referenced by the ExternalResourceReference cannot support CAD links. -or- The ExternalResourceReference (resourceReference) is not in a format that is supported by its server. |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | A non-optional argument was null |
| [Autodesk.Revit.Exceptions..::..ModificationForbiddenException](53205486-5917-7c33-8e67-e362106ddc97.md) | The document is in failure mode: an operation has failed, and Revit requires the user to either cancel the operation or fix the problem (usually by deleting certain elements). -or- The document is being loaded, or is in the midst of another sensitive process. |
| [Autodesk.Revit.Exceptions..::..ModificationOutsideTransactionException](8f025460-c283-ea99-aa8a-5a36e11528f4.md) | The document has no open transaction. |
| [Autodesk.Revit.Exceptions..::..OptionalFunctionalityNotAvailableException](0612a676-b6ba-8c37-2e28-b197438305ab.md) | The 3DM Import/Link module is not available in the installed Revit. |
  
# See Also

[ImportInstance Class](85b534b8-dd6c-bc13-7c46-c803c83481e4.md)

[Create Overload](ddb7b91a-482e-5cb6-edf6-913781024602.md)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)