

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
DocumentPreviewSettings Class  
[Members](bd26956e-137f-07a1-605f-d9e2115f5c47.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Contains the settings related to the saving of preview images for a given document. 

**Namespace:** [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2012 

# Syntax

C#  
---  
      
    
    public class DocumentPreviewSettings : IDisposable  
  
Visual Basic  
---  
      
    
    Public Class DocumentPreviewSettings _
    	Implements IDisposable  
  
Visual C++  
---  
      
    
    public ref class DocumentPreviewSettings : IDisposable  
  
# Examples

CopyC#
    
    
    // Get the document's preview settings
    DocumentPreviewSettings settings = document.GetDocumentPreviewSettings();
    
    // Find a candidate 3D view
    FilteredElementCollector collector = new FilteredElementCollector(document);
    collector.OfClass(typeof(View3D));
    
    Func<View3D, bool> isValidForPreview = v => settings.IsViewIdValidForPreview(v.Id);
    
    View3D viewForPreview = collector.OfType<View3D>().First<View3D>(isValidForPreview);
    
    // Set the preview settings
    using (Transaction setTransaction = new Transaction(document, "Set preview view id"))
    {
       setTransaction.Start();
       settings.PreviewViewId = viewForPreview.Id;
       setTransaction.Commit();
    }
    
    // Save the document
    document.Save();

CopyVB.NET
    
    
    ' Get the document's preview settings
    Dim settings As DocumentPreviewSettings = document.GetDocumentPreviewSettings()
    
    ' Find a candidate 3D view
    Dim collector As New FilteredElementCollector(document)
    collector.OfClass(GetType(View3D))
    
    Dim isValidForPreview As Func(Of View3D, Boolean) = Function(v) settings.IsViewIdValidForPreview(v.Id)
    
    Dim viewForPreview As View3D = collector.OfType(Of View3D)().First(isValidForPreview)
    
    ' Set the preview settings
    Using setTransaction As New Transaction(document, "Set preview view id")
        setTransaction.Start()
        settings.PreviewViewId = viewForPreview.Id
        setTransaction.Commit()
    End Using
    
    ' Save the document
    document.Save()

# Inheritance Hierarchy

System..::..Object Autodesk.Revit.DB..::..DocumentPreviewSettings

# See Also

[DocumentPreviewSettings Members](bd26956e-137f-07a1-605f-d9e2115f5c47.md)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)