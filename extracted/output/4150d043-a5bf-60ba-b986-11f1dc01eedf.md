

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
SketchEditScope..::..StartWithNewSketch Method   
[SketchEditScope Class](8538b361-08df-9fd2-93bb-1790a09130f7.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Starts a sketch edit mode for an element which, at this moment, doesn't have a sketch. 

**Namespace:** [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2023 

# Syntax

C#  
---  
      
    
    public void StartWithNewSketch(
    	[ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md) elementId
    )  
  
Visual Basic  
---  
      
    
    Public Sub StartWithNewSketch ( _
    	elementId As [ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md) _
    )  
  
Visual C++  
---  
      
    
    public:
    void StartWithNewSketch(
    	[ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md)^ elementId
    )  
  
#### Parameters

elementId
    Type: [Autodesk.Revit.DB..::..ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md) The Element without sketch to be edited. 

# Remarks

Some surface Revit elements (like some Walls or some Analytical Elements) does not have a valid sketch all the time so in order to edit them, we have to create a valid sketch first. The application will need to start a transaction to actually make changes to the element. SketchEditScope can only be started when there is no transaction active, thus it does not work for commands running in automatic transaction mode. 

# Examples

CopyC#
    
    
    Document document = commandData.Application.ActiveUIDocument.Document;
    
    //create analytical panel
    AnalyticalPanel analyticalPanel = CreateAnalyticalPanel.CreateAMPanel(document);
    if (analyticalPanel != null)
    {
       // Start a sketch edit scope
       SketchEditScope sketchEditScope = new SketchEditScope(document, "Replace line with an arc");
       sketchEditScope.StartWithNewSketch(analyticalPanel.Id);
    
       using (Transaction transaction = new Transaction(document, "Modify sketch"))
       {
          transaction.Start();
    
          //replace a boundary line with an arc
          Line line = null;
          Sketch sketch = document.GetElement(analyticalPanel.SketchId) as Sketch;
          if (sketch != null)
          {
             foreach (CurveArray curveArray in sketch.Profile)
             {
                foreach (Curve curve in curveArray)
                {
                   line = curve as Line;
                   if (line != null)
                   {
                      break;
                   }
                }
                if (line != null)
                {
                   break;
                }
             }
          }
    
          // Create arc
          XYZ normal = line.Direction.CrossProduct(XYZ.BasisZ).Normalize().Negate();
          XYZ middle = line.GetEndPoint(0).Add(line.Direction.Multiply(line.Length / 2));
          Curve arc = Arc.Create(line.GetEndPoint(0), line.GetEndPoint(1), middle.Add(normal.Multiply(20)));
    
          // Remove element referenced by the found line. 
          document.Delete(line.Reference.ElementId);
    
          // Model curve creation automatically puts the curve into the sketch, if sketch edit scope is running.
          document.Create.NewModelCurve(arc, sketch.SketchPlane);
    
          transaction.Commit();
       }
    
       sketchEditScope.Commit(new FailurePreproccessor());
    
    }
    
    return Result.Succeeded;

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentException](2e6e4206-97a8-dd4b-df5d-4269f4bb6088.md) | The ElementId elementId already has a sketch defined. -or- Element does not support sketch editing. -or- Failed to start the sketch edit mode. |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | A non-optional argument was null |
| [Autodesk.Revit.Exceptions..::..InvalidOperationException](9e715f03-3884-e539-4dd6-8d7545733adc.md) | This SketchEditScope is not permitted to start at this moment for one of the following possible reasons: The document is in read-only state, or the document is currently modifiable, or there already is another edit mode active in the document. -or- Cannot create sketch. |
  
# See Also

[SketchEditScope Class](8538b361-08df-9fd2-93bb-1790a09130f7.md)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)