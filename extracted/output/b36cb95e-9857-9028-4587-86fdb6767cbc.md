

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
ViewSystemsAnalysisReport..::..RequestSystemsAnalysis Method   
[ViewSystemsAnalysisReport Class](a7b5b7de-dfdb-e57f-7fac-1ff1dbf35e4d.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Requests a new systems analysis in the background. 

**Namespace:** [Autodesk.Revit.DB.Analysis](958e2e12-587d-f188-5d7b-f13d7dbfdf48.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2020.1 

# Syntax

C#  
---  
      
    
    public void RequestSystemsAnalysis(
    	[SystemsAnalysisOptions](8d8fe6a8-d3f6-c4fd-99ac-3181ba0253d6.md) options
    )  
  
Visual Basic  
---  
      
    
    Public Sub RequestSystemsAnalysis ( _
    	options As [SystemsAnalysisOptions](8d8fe6a8-d3f6-c4fd-99ac-3181ba0253d6.md) _
    )  
  
Visual C++  
---  
      
    
    public:
    void RequestSystemsAnalysis(
    	[SystemsAnalysisOptions](8d8fe6a8-d3f6-c4fd-99ac-3181ba0253d6.md)^ options
    )  
  
#### Parameters

options
    Type: [Autodesk.Revit.DB.Analysis..::..SystemsAnalysisOptions](8d8fe6a8-d3f6-c4fd-99ac-3181ba0253d6.md) The additional options to run systems analysis. If empty, use the default value in the view element. The request may download the weather file at current site location if not specified in the options. 

# Examples

CopyC#
    
    
    // Create a new report and request systems analysis on the current energy model.
    ViewSystemsAnalysisReport newReport = null;
    
    SystemsAnalysisOptions theOptions = new SystemsAnalysisOptions();
    string openStudioPath = Path.GetFullPath(Path.Combine(doc.Application.SystemsAnalysisWorkfilesRootPath, @"..\"));
    // The following are the default values for systems analysis if not specified.
    // If the weather file is not specified, the analysis will use the weather at the current site location.
    theOptions.WorkflowFile = Path.Combine(openStudioPath, @"workflows\HVAC Systems Loads and Sizing.osw");
    theOptions.OutputFolder = Path.GetTempPath();
    using (Transaction transaction = new Transaction(doc))
    {
       transaction.Start("Create Systems Analysis View");
    
       newReport = ViewSystemsAnalysisReport.Create(doc, "APITestView");
       // Create a new report of systems analysis. 
       if (newReport != null)
       {
          newReport.RequestSystemsAnalysis(theOptions);
          // Request the systems analysis in the background process. When the systems analysis is completed, 
          // the result is automatically updated in the report view and the analytical space elements.
          // You may check the status by calling newReport.IsAnalysisCompleted().
          transaction.Commit();
       }
       else
       {
          transaction.RollBack();
       }
    }

CopyVB.NET
    
    
    ' Create a New report And request systems analysis on the current energy model.
    Dim newReport As ViewSystemsAnalysisReport = Nothing
    
    Dim theOptions As SystemsAnalysisOptions = New SystemsAnalysisOptions()
    Dim openStudioPath As String = Path.GetFullPath(Path.Combine(doc.Application.SystemsAnalysisWorkfilesRootPath, "..\"))
    ' The following are the default values for systems analysis if not specified.
    ' If the weather file is not specified, the analysis will use the weather at the current site location.
    theOptions.WorkflowFile = Path.Combine(openStudioPath, "workflows\HVAC Systems Loads and Sizing.osw")
    theOptions.OutputFolder = Path.GetTempPath()
    Using t As New Transaction(doc, "Create Systems Analysis View")
       t.Start()
    
       newReport = ViewSystemsAnalysisReport.Create(doc, "APITestView")
       ' Create a new report of systems analysis. 
       If newReport IsNot Nothing Then
          newReport.RequestSystemsAnalysis(theOptions)
          ' Request the systems analysis in the background process. When the systems analysis Is completed, 
          ' the result Is automatically updated in the report view And the analytical space elements.
          ' You may check the status by calling newReport.IsAnalysisCompleted().
          t.Commit()
       Else
          t.RollBack()
       End If
    End Using

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | A non-optional argument was null |
| [Autodesk.Revit.Exceptions..::..ArgumentsInconsistentException](05972c68-fa6d-3a83-d720-ad84fbc4780f.md) | No weather station is within 500 nautical miles of this site location. |
| [Autodesk.Revit.Exceptions..::..FileNotFoundException](73250198-dbc6-e760-4297-ec062f00f574.md) | Fail to download the weather file. |
| [Autodesk.Revit.Exceptions..::..InvalidOperationException](9e715f03-3884-e539-4dd6-8d7545733adc.md) | A valid energy model is required for systems analysis. -or- Unable to access the weather service. Try again later. |
  
# See Also

[ViewSystemsAnalysisReport Class](a7b5b7de-dfdb-e57f-7fac-1ff1dbf35e4d.md)

[Autodesk.Revit.DB.Analysis Namespace](958e2e12-587d-f188-5d7b-f13d7dbfdf48.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)