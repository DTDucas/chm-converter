

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
Transaction..::..Commit Method   
[Transaction Class](308ebf8d-d96d-4643-cd1d-34fffcea53fd.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Commits all changes made to the model during the transaction. 

**Namespace:** [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)

# Syntax

C#  
---  
      
    
    public [TransactionStatus](29b9a7a8-6754-8310-e063-622b569bb6d5.md) Commit()  
  
Visual Basic  
---  
      
    
    Public Function Commit As [TransactionStatus](29b9a7a8-6754-8310-e063-622b569bb6d5.md)  
  
Visual C++  
---  
      
    
    public:
    [TransactionStatus](29b9a7a8-6754-8310-e063-622b569bb6d5.md) Commit()  
  
#### Return Value

If finished successfully, this method returns TransactionStatus.Committed. 

Note it is possible the RolledBack status is returned instead as an outcome of failure handling. If TransactionStatus::Pending is returned it means that failure handling has not been finalized yet and Revit awaits a user actions. Until committing is fully finalized, no changes to the document can be made (including starting of new transactions).

The returned status does not have to be necessarily the same as the status returned by [GetStatus()()()()](fdf98941-eee4-d8af-e3f7-5b6c7ccc3c74.md) even when the method is called immediately after committing the transaction. Such a difference may happen due to actions made by a transaction finalizer, if there was one set. (See [FailureHandlingOptions](c03bb2e5-f679-bf24-4e87-08b3c3a08385.md) for more details.)

# Remarks

By committing a transaction, all changes made to the model during the transaction are accepted. A new undo item will appear in the Undo menu in Revit, which allows the user to undo the changes. The undo item will have this transaction's name. Commit may only be called for a transaction that has been started. (Use the [GetStatus()()()()](fdf98941-eee4-d8af-e3f7-5b6c7ccc3c74.md) method to check the current state.) Be aware that committing may fail or can be delayed (as a result of failure handling.) Callers should always check the returned status to test whether a transaction was committed successfully. Only after a transaction is successfully committed (or rolled back as a result of handling transaction failures), it may be started again. 

# Examples

CopyC#
    
    
    public bool CreateLevel(Autodesk.Revit.DB.Document document, double elevation)
    {
       // All and any transaction should be enclosed in a 'using'
       // block or guarded within a try-catch-finally blocks
       // to guarantee that a transaction does not out-live its scope.
       using (Transaction transaction = new Transaction(document, "Creating Level"))
        {
           // Must start a transaction to be able to modify a document
    
           if( TransactionStatus.Started == transaction.Start())
           {
              if (null != Level.Create(document, elevation))
              {
                 // For many various reasons, a transaction may not be committed
                 // if the changes made during the transaction do not result a valid model.
                 // If committing a transaction fails or is canceled by the end user,
                 // the resulting status would be RolledBack instead of Committed.
                 return (TransactionStatus.Committed == transaction.Commit());
              }
    
              // For we were unable to create the level, we will roll the transaction back
              // (although on this simplified case we know there weren't any other changes)
    
              transaction.RollBack();
           }
        }
        return false;
    }

CopyVB.NET
    
    
    Public Function CreateLevel(document As Autodesk.Revit.DB.Document, elevation As Double) As Boolean
        ' All and any transaction should be enclosed in a 'using'
        ' block or guarded within a try-catch-finally blocks
        ' to guarantee that a transaction does not out-live its scope.
        Using transaction As New Transaction(document, "Creating Level")
            ' Must start a transaction to be able to modify a document
    
    
            If TransactionStatus.Started = transaction.Start() Then
           If Level.Create(document, elevation) IsNot Nothing Then
              ' For many various reasons, a transaction may not be committed
              ' if the changes made during the transaction do not result a valid model.
              ' If committing a transaction fails or is canceled by the end user,
              ' the resulting status would be RolledBack instead of Committed.
              Return (TransactionStatus.Committed = transaction.Commit())
           End If
    
                ' For we were unable to create the level, we will roll the transaction back
                ' (although on this simplified case we know there weren't any other changes)
    
    
                transaction.RollBack()
            End If
        End Using
        Return False
    End Function

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..InvalidOperationException](9e715f03-3884-e539-4dd6-8d7545733adc.md) | The current status of the transaction is not 'Started'. Transaction must be started before calling Commit or Rollback. -or- The transaction's document is currently in failure mode. No transaction operations are permitted until failure handling is finished. |
  
# See Also

[Transaction Class](308ebf8d-d96d-4643-cd1d-34fffcea53fd.md)

[Commit Overload](bb7917ec-9fc7-b0a8-e3b7-2b38015cbc08.md)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)