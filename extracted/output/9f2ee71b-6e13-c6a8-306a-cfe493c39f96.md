

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
Revision..::..CombineWithNext Method   
[Revision Class](af882c60-68ae-2e53-5c41-7aa43cfc1df4.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Combines the specified Revision with the next Revision. 

**Namespace:** [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2015 

# Syntax

C#  
---  
      
    
    public static ISet<[ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md)> CombineWithNext(
    	[Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md) document,
    	[ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md) revisionId
    )  
  
Visual Basic  
---  
      
    
    Public Shared Function CombineWithNext ( _
    	document As [Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md), _
    	revisionId As [ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md) _
    ) As ISet(Of [ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md))  
  
Visual C++  
---  
      
    
    public:
    static ISet<[ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md)^>^ CombineWithNext(
    	[Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md)^ document, 
    	[ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md)^ revisionId
    )  
  
#### Parameters

document
    Type: [Autodesk.Revit.DB..::..Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md) The Document containing the Revisions. 

revisionId
    Type: [Autodesk.Revit.DB..::..ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md) The Revision that should have its clouds and tags associated with the next Revision. 

#### Return Value

The ids of all RevisionClouds that were reassigned to the next Revision. 

# Remarks

All RevisionClouds and tags associated with the specified Revision will be reassigned to the next Revision in the model and the specified Revision will be deleted from the model. The operation can only be performed if both the specified Revision and the next one are unissued. 

# Examples

CopyC#
    
    
    private bool CombineRevision(Document document, Revision revision)
    {
        bool combined = false;
        // Can only combine two revisions if neither have been issued
        if (revision.Issued == false)
        {
            ElementId revisionId = revision.Id;
            Revision nextRevsion = GetNextRevision(document, revisionId);
            if (nextRevsion != null && nextRevsion.Issued == false)
            {
                ISet<ElementId> revisionCloudIds = Revision.CombineWithNext(document, revisionId);
                combined = true;
                int movedClouds = revisionCloudIds.Count;
                if (movedClouds > 0)
                {
                    RevisionCloud cloud = document.GetElement(revisionCloudIds.ElementAt(0)) as RevisionCloud;
                    if (cloud != null)
                    {
                        string msg = string.Format("Revision {0} deleted and {1} revision clouds were added to Revsion {2}",
                            revisionId.ToString(), movedClouds, cloud.RevisionId.ToString());
                        TaskDialog.Show("Revision Combined", msg);
                    }
                }
            }
        }
    
        return combined;
    }
    
    private Revision GetNextRevision(Document document, ElementId currentRevisionId)
    {
        Revision nextRevision = null;
        IList<ElementId> revisionIds = Revision.GetAllRevisionIds(document);
        int currentRevisionIndex = -1;
        for (int n = 0; n < revisionIds.Count; n++)
        {
            if (revisionIds[n] == currentRevisionId)
            {
                currentRevisionIndex = n;
                break;
            }
        }
    
        // if the current revision id was found and is not the last index
        if (currentRevisionIndex >= 0 && currentRevisionIndex < revisionIds.Count - 1)
        {
            ElementId nextRevisionId = revisionIds[currentRevisionIndex + 1];
            nextRevision = document.GetElement(nextRevisionId) as Revision;
        }
    
        return nextRevision;
    }

CopyVB.NET
    
    
    Private Function CombineRevision(document As Document, revision__1 As Revision) As Boolean
        Dim combined As Boolean = False
        ' Can only combine two revisions if neither have been issued
        If revision__1.Issued = False Then
            Dim revisionId As ElementId = revision__1.Id
            Dim nextRevsion As Revision = GetNextRevision(document, revisionId)
            If nextRevsion IsNot Nothing AndAlso nextRevsion.Issued = False Then
                Dim revisionCloudIds As ISet(Of ElementId) = Revision.CombineWithNext(document, revisionId)
                combined = True
                Dim movedClouds As Integer = revisionCloudIds.Count
                If movedClouds > 0 Then
                    Dim cloud As RevisionCloud = TryCast(document.GetElement(revisionCloudIds.ElementAt(0)), RevisionCloud)
                    If cloud IsNot Nothing Then
                        Dim msg As String = String.Format("Revision {0} deleted and {1} revision clouds were added to Revsion {2}", revisionId.ToString(), movedClouds, cloud.RevisionId.ToString())
                        TaskDialog.Show("Revision Combined", msg)
                    End If
                End If
            End If
        End If
    
        Return combined
    End Function
    
    Private Function GetNextRevision(document As Document, currentRevisionId As ElementId) As Revision
        Dim nextRevision As Revision = Nothing
        Dim revisionIds As IList(Of ElementId) = Revision.GetAllRevisionIds(document)
        Dim currentRevisionIndex As Integer = -1
        For n As Integer = 0 To revisionIds.Count - 1
            If revisionIds(n) = currentRevisionId Then
                currentRevisionIndex = n
                Exit For
            End If
        Next
    
        ' if the current revision id was found and is not the last index
        If currentRevisionIndex >= 0 AndAlso currentRevisionIndex < revisionIds.Count - 1 Then
            Dim nextRevisionId As ElementId = revisionIds(currentRevisionIndex + 1)
            nextRevision = TryCast(document.GetElement(nextRevisionId), Revision)
        End If
    
        Return nextRevision
    End Function

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentException](2e6e4206-97a8-dd4b-df5d-4269f4bb6088.md) | revisionId is not a valid Revision. -or- This operation cannot be performed because revisionId is an issued Revision. -or- revisionId cannot be combined with the next Revision because either revisionId is the last Revision or the next Revision has already been issued. |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | A non-optional argument was null |
  
# See Also

[Revision Class](af882c60-68ae-2e53-5c41-7aa43cfc1df4.md)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)