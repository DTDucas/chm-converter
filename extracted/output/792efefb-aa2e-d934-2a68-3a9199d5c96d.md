

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
IExternalService..::..OnServersChanged Method   
[IExternalService Interface](37fe86a0-0668-5908-9966-dfac0e0c1fe3.md) See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Implement this method to handle situations when servers for the service have changed. 

**Namespace:** [Autodesk.Revit.DB.ExternalService](a88f2d1d-c02f-a901-9543-44e4b5dd5fc9.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2013 

# Syntax

C#  
---  
      
    
    void OnServersChanged(
    	[Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md) document,
    	[ServerChangeCause](02016116-f6cf-5d3a-94df-811ef76bdebc.md) cause,
    	IList<Guid> oldServers
    )  
  
Visual Basic  
---  
      
    
    Sub OnServersChanged ( _
    	document As [Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md), _
    	cause As [ServerChangeCause](02016116-f6cf-5d3a-94df-811ef76bdebc.md), _
    	oldServers As IList(Of Guid) _
    )  
  
Visual C++  
---  
      
    
    void OnServersChanged(
    	[Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md)^ document, 
    	[ServerChangeCause](02016116-f6cf-5d3a-94df-811ef76bdebc.md) cause, 
    	IList<Guid>^ oldServers
    )  
  
#### Parameters

document
    Type: [Autodesk.Revit.DB..::..Document](db03274b-a107-aa32-9034-f3e0df4bb1ec.md) The corresponding document 

cause
    Type: [Autodesk.Revit.DB.ExternalService..::..ServerChangeCause](02016116-f6cf-5d3a-94df-811ef76bdebc.md) Indicates in what situation the servers are changed. Currently available values indicate whether the change is a result of an explicit user request, or by an implicit change of situation within the service - for example when a document is updated upon opening. 

oldServers
    Type: System.Collections.Generic..::..IList<(Of <(<'Guid>)>)> Ids of servers previously used in the document. Please note that the Ids may belong to servers that are not registered with service anymore. 

# Remarks

This method may only be invoked in a recordable service. Services registered as non-recordable never receive this call. 

It is imperative to understand this method is not called just when an active server (or servers) is (are) changed for a service. It is invoked only when the active server is changed so it is different from those previously used (i.e. actually executed) in a document. Because of that, this notification is never sent when active server is set or reset in a document in which the service was never executed before. 

If a document has explicitly set active server (or servers), OnServersChanged is never called for that document when the application-wide active server (servers) gets changed. The document would still be executed with its own active servers applied. A similar case is when the active server (servers) is unset for a document but the currently active application-wide server happens to be the same as the one that was set in the document. 

It is up to the service provider to decide what should be the appropriate action. In some cases, if not all, the service will probably want to execute again, now with the new active server(s), but that it is not necessary - the service invoker may as well decide to wait for the end-user to trigger execution if the service (e.g. by clicking a corresponding command in the menu.) 

# See Also

[IExternalService Interface](37fe86a0-0668-5908-9966-dfac0e0c1fe3.md)

[Autodesk.Revit.DB.ExternalService Namespace](a88f2d1d-c02f-a901-9543-44e4b5dd5fc9.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)