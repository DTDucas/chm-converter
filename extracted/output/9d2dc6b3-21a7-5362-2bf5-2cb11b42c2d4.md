

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
IExportContext..::..OnMaterial Method   
[IExportContext Interface](7d0dc6df-db0e-6a07-3b42-8dde1bedb3c1.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
This method marks a change of the material. 

**Namespace:** [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2014 

# Syntax

C#  
---  
      
    
    void OnMaterial(
    	[MaterialNode](c70338a6-7f40-e89e-607b-47162df3a5ef.md) node
    )  
  
Visual Basic  
---  
      
    
    Sub OnMaterial ( _
    	node As [MaterialNode](c70338a6-7f40-e89e-607b-47162df3a5ef.md) _
    )  
  
Visual C++  
---  
      
    
    void OnMaterial(
    	[MaterialNode](c70338a6-7f40-e89e-607b-47162df3a5ef.md)^ node
    )  
  
#### Parameters

node
    Type: [Autodesk.Revit.DB..::..MaterialNode](c70338a6-7f40-e89e-607b-47162df3a5ef.md) A node describing the current material. 

# Examples

CopyC#
    
    
    ElementId currentMaterialId = ElementId.InvalidElementId;
    Color currentColor = new Color(0,0,0);
    double currentTransparency = 0;
    Asset currentAppearance = null;
    
    /// <summary>
    /// This code demonstrates how to process material information
    /// </summary>
    /// <remarks>
    /// OnMaterial method can be invoked for every single out-coming mesh
    /// even when the material has not actually changed. Thus it is usually
    /// beneficial to store the current material and only get its attributes
    /// when the material actually changes.
    /// </remarks>
    public void OnMaterial(MaterialNode node)
    {
       // acquire properties of the material if it is different
       // than the material we have set as the currently applicable
       if (currentMaterialId != node.MaterialId)
       {
          if (node.MaterialId != ElementId.InvalidElementId)
          {
             currentColor = node.Color;
             currentTransparency = node.Transparency;
          }
          else
          {
             // the default material is being used in this case
          }
    
          // Appearance Asset is mainly for Revit internal use. However, if it is utilized 
          // in the export context, it needs to be checked whether or not the asset of the 
          // material is overridden by some local modification (e.g. by applying a decal)
    
          if (node.HasOverriddenAppearance)
          {
             currentAppearance = node.GetAppearanceOverride();
          }
          else
          {
             currentAppearance = node.GetAppearance();
          }
       }
    }

CopyVB.NET
    
    
    Private currentMaterialId As ElementId = ElementId.InvalidElementId
    Private currentColor As New Color(0, 0, 0)
    Private currentTransparency As Double = 0
    Private currentAppearance As Asset = Nothing
    
    ' <summary>
    ' This code demonstrates how to process material information
    ' </summary>
    ' <remarks>
    ' OnMaterial method can be invoked for every single out-coming mesh
    ' even when the material has not actually changed. Thus it is usually
    ' beneficial to store the current material and only get its attributes
    ' when the material actually changes.
    ' </remarks>
    Public Sub OnMaterial(node As MaterialNode) Implements IExportContext.OnMaterial
        ' acquire properties of the material if it is different
        ' than the material we have set as the currently applicable
        If currentMaterialId <> node.MaterialId Then
            If node.MaterialId <> ElementId.InvalidElementId Then
                currentColor = node.Color
                currentTransparency = node.Transparency
                ' the default material is being used in this case
            Else
            End If
    
            ' Appearance Asset is mainly for Revit internal use. However, if it is utilized 
            ' in the export context, it needs to be checked whether or not the asset of the 
            ' material is overridden by some local modification (e.g. by applying a decal)
    
    
            If node.HasOverriddenAppearance Then
                currentAppearance = node.GetAppearanceOverride()
            Else
                currentAppearance = node.GetAppearance()
            End If
        End If
    End Sub

# See Also

[IExportContext Interface](7d0dc6df-db0e-6a07-3b42-8dde1bedb3c1.md)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)