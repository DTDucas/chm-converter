

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
IExportContext..::..OnPolymesh Method   
[IExportContext Interface](7d0dc6df-db0e-6a07-3b42-8dde1bedb3c1.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
This method is called when a tessellated polymesh of a 3d face is being output. 

**Namespace:** [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2014 

# Syntax

C#  
---  
      
    
    void OnPolymesh(
    	[PolymeshTopology](fef5982c-3825-eed0-f792-1e0bff5509c2.md) node
    )  
  
Visual Basic  
---  
      
    
    Sub OnPolymesh ( _
    	node As [PolymeshTopology](fef5982c-3825-eed0-f792-1e0bff5509c2.md) _
    )  
  
Visual C++  
---  
      
    
    void OnPolymesh(
    	[PolymeshTopology](fef5982c-3825-eed0-f792-1e0bff5509c2.md)^ node
    )  
  
#### Parameters

node
    Type: [Autodesk.Revit.DB..::..PolymeshTopology](fef5982c-3825-eed0-f792-1e0bff5509c2.md) A node representing topology of the polymesh 

# Examples

CopyC#
    
    
    /// <summary>
    /// This method is called up for every face that was processed and tessellated
    /// </summary>
    /// <remarks>
    /// The node provides all information about geometric topology if the mesh.
    /// It is assumed that a concrete exporter would consume the part it can 
    /// understand and/or support (vertices, normals, UVs, etc.) and convert
    /// them into the final, export format.
    /// </remarks>
    public void OnPolymesh(PolymeshTopology node)
    {
       // Note: the current material will get applied to the polymesh.
    
       // If a stack of transformation is maintained by the context object,
       // the current combined transform will be applied to the points.
       Transform currentTransform = m_TransformationStack.Peek();
    
       // basic properties of the mesh
    
       int numberOfFacet = node.NumberOfFacets;
       int numberOfPoints = node.NumberOfPoints;
       int numberOfUVs = node.NumberOfUVs;
       int numberOfNormal = node.NumberOfNormals;
    
       // Note: Normals are associated with either points or facets of the polymesh
       // The export code must account for different processing of these two cases.
    
       // A) process points of the polymesh
    
       if( node.DistributionOfNormals == DistributionOfNormals.AtEachPoint )
       {
          ExportMeshPoints(node.GetPoints(), currentTransform, node.GetNormals() );
       }
       else if( node.DistributionOfNormals == DistributionOfNormals.OnePerFace )
       {
          ExportMeshPoints(node.GetPoints(), currentTransform, node.GetNormal(0) );
       }
       else  // DistributionOfNormals.OnEachFacet
       {
          // In this case, there is normal vector associated with each facet
          // Depending on the export, our format either support this case,
          // of we would have to determine what normals to apply at each 
          // point by a way of combining normal of the surrounding facets.
          ExportMeshPoints(node.GetPoints(), currentTransform );
       }
    
       // B Process facets of the polymesh
    
       if( node.DistributionOfNormals == DistributionOfNormals.OnEachFacet )
       {
          ExportMeshFacets(node.GetFacets(), node.GetNormals() );
       }
       else
       {
          ExportMeshFacets(node.GetFacets(), null );
       }
    
       // B) Process UV coordinates if available (and applicable)
    
       if( node.NumberOfUVs > 0 )
       {
          ExportMeshUVs( node.GetUVs() );
       }
    }
    
    private void ExportMeshPoints(IList<XYZ> points, Transform trf, IList<XYZ> normals)
    {
       // process points with normals
    }
    
    private void ExportMeshPoints(IList<XYZ> points, Transform trf, XYZ normal)
    {
       // process points with only one normal vector (a planar face)
    }
    
    private void ExportMeshPoints(IList<XYZ> points, Transform trf)
    {
       // process points without normal (assuming normals are associated with facets instead)
    }
    
    private void ExportMeshFacets(IList<PolymeshFacet> facets, IList<XYZ> normals)
    {
       if (normals == null)
       {
          // process facets without normals  (assuming normals are associated with points instead)
       }
       else
       {
          // process facets with normals
       }
    }
    
    private void ExportMeshUVs(IList<UV> UVs)
    {
       // process UVs
    }

CopyVB.NET
    
    
    ' <summary>
    ' This method is called up for every face that was processed and tessellated
    ' </summary>
    ' <remarks>
    ' The node provides all information about geometric topology if the mesh.
    ' It is assumed that a concrete exporter would consume the part it can 
    ' understand and/or support (vertices, normals, UVs, etc.) and convert
    ' them into the final, export format.
    ' </remarks>
    Public Sub OnPolymesh(node As PolymeshTopology) Implements IExportContext.OnPolymesh
        ' Note: the current material will get applied to the polymesh.
    
    
        ' If a stack of transformation is maintained by the context object,
        ' the current combined transform will be applied to the points.
        Dim currentTransform As Transform = m_TransformationStack.Peek()
    
        ' basic properties of the mesh
    
    
        Dim numberOfFacet As Integer = node.NumberOfFacets
        Dim numberOfPoints As Integer = node.NumberOfPoints
        Dim numberOfUVs As Integer = node.NumberOfUVs
        Dim numberOfNormal As Integer = node.NumberOfNormals
    
        ' Note: Normals are associated with either points or facets of the polymesh
        ' The export code must account for different processing of these two cases.
    
    
        ' A) process points of the polymesh
    
    
        If node.DistributionOfNormals = DistributionOfNormals.AtEachPoint Then
            ExportMeshPoints(node.GetPoints(), currentTransform, node.GetNormals())
        ElseIf node.DistributionOfNormals = DistributionOfNormals.OnePerFace Then
            ExportMeshPoints(node.GetPoints(), currentTransform, node.GetNormal(0))
        Else
            ' DistributionOfNormals.OnEachFacet
            ' In this case, there is normal vector associated with each facet
            ' Depending on the export, our format either support this case,
            ' of we would have to determine what normals to apply at each 
            ' point by a way of combining normal of the surrounding facets.
            ExportMeshPoints(node.GetPoints(), currentTransform)
        End If
    
        ' B Process facets of the polymesh
    
    
        If node.DistributionOfNormals = DistributionOfNormals.OnEachFacet Then
            ExportMeshFacets(node.GetFacets(), node.GetNormals())
        Else
            ExportMeshFacets(node.GetFacets(), Nothing)
        End If
    
        ' B) Process UV coordinates if available (and applicable)
    
    
        If node.NumberOfUVs > 0 Then
            ExportMeshUVs(node.GetUVs())
        End If
    End Sub
    
    Private Sub ExportMeshPoints(points As IList(Of XYZ), trf As Transform, normals As IList(Of XYZ))
        ' process points with normals
    End Sub
    
    Private Sub ExportMeshPoints(points As IList(Of XYZ), trf As Transform, normal As XYZ)
        ' process points with only one normal vector (a planar face)
    End Sub
    
    Private Sub ExportMeshPoints(points As IList(Of XYZ), trf As Transform)
        ' process points without normal (assuming normals are associated with facets instead)
    End Sub
    
    Private Sub ExportMeshFacets(facets As IList(Of PolymeshFacet), normals As IList(Of XYZ))
        ' process facets without normals  (assuming normals are associated with points instead)
        If normals Is Nothing Then
            ' process facets with normals
        Else
        End If
    End Sub
    
    Private Sub ExportMeshUVs(UVs As IList(Of UV))
        ' process UVs
    End Sub

# See Also

[IExportContext Interface](7d0dc6df-db0e-6a07-3b42-8dde1bedb3c1.md)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)