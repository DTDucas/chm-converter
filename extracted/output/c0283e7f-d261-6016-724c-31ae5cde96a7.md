

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
Transaction..::..SetName Method   
[Transaction Class](308ebf8d-d96d-4643-cd1d-34fffcea53fd.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Sets the transaction's name. 

**Namespace:** [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)

# Syntax

C#  
---  
      
    
    public void SetName(
    	string name
    )  
  
Visual Basic  
---  
      
    
    Public Sub SetName ( _
    	name As String _
    )  
  
Visual C++  
---  
      
    
    public:
    void SetName(
    	String^ name
    )  
  
#### Parameters

name
    Type: System..::..String A name for the transaction. 

# Remarks

A transaction needs a name before it can be started, i.e. before one of the 'Start' method is invoked for this transaction object. The name will later appear in the Undo menu in Revit after a transaction is successfully committed. 

Another ways of setting the name is either during construction or during the [Start(String)](5fb266f4-5eca-049f-6a30-f3ed76687409.md) method.

# Examples

CopyC#
    
    
    public bool ModelChangingMethod(Autodesk.Revit.DB.Document document)
    {
        bool result = false;
    
        // All and any transaction should be enclosed in a 'using'
        // block or guarded within a try-catch-finally blocks
        // to guarantee that a transaction does not out-live its scope.
        using (Transaction transaction = new Transaction(document))
        {
            // We can either start a transaction with a name or give
            // it a name later, but we have to name it before we commit.
            transaction.Start();
    
            // Some modification(s) of the model here, likely resulting in 
            // changes of the 'result' value
            // result = ..... 
    
            if (result == true)
            {
                // Since the transaction is still unnamed,
                // we have to give it a name now before we commit
    
                transaction.SetName("Model change");
    
                // Now we can commit
                if (TransactionStatus.Committed != transaction.Commit())
                {
                    result = false;
                }
            }
            else  // if modifications failed, transaction is to be rolled back
            {
                transaction.RollBack();
            }
        }
        return result;
    }

CopyVB.NET
    
    
    Public Function ModelChangingMethod(document As Autodesk.Revit.DB.Document) As Boolean
        Dim result As Boolean = False
    
        ' All and any transaction should be enclosed in a 'using'
        ' block or guarded within a try-catch-finally blocks
        ' to guarantee that a transaction does not out-live its scope.
        Using transaction As New Transaction(document)
            ' We can either start a transaction with a name or give
            ' it a name later, but we have to name it before we commit.
            transaction.Start()
    
            ' Some modification(s) of the model here, likely resulting in 
            ' changes of the 'result' value
            ' result = ..... 
    
    
            If result = True Then
                ' Since the transaction is still unnamed,
                ' we have to give it a name now before we commit
    
    
                transaction.SetName("Model change")
    
                ' Now we can commit
                If TransactionStatus.Committed <> transaction.Commit() Then
                    result = False
                End If
            Else
                ' if modifications failed, transaction is to be rolled back
                transaction.RollBack()
            End If
        End Using
        Return result
    End Function

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentException](2e6e4206-97a8-dd4b-df5d-4269f4bb6088.md) | The name argument is an empty string. |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | A non-optional argument was null |
  
# See Also

[Transaction Class](308ebf8d-d96d-4643-cd1d-34fffcea53fd.md)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)