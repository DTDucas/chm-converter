

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
SketchEditScope Class  
[Members](8dec7402-1bdf-526d-b4ed-371700cfb673.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
A SketchEditScope allows an application to create and maintain an editing session for a Sketch. 

**Namespace:** [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2022 

# Syntax

C#  
---  
      
    
    public class SketchEditScope : [EditScope](bac11282-3a3b-953e-8bc4-960c62da4946.md)  
  
Visual Basic  
---  
      
    
    Public Class SketchEditScope _
    	Inherits [EditScope](bac11282-3a3b-953e-8bc4-960c62da4946.md)  
  
Visual C++  
---  
      
    
    public ref class SketchEditScope : public [EditScope](bac11282-3a3b-953e-8bc4-960c62da4946.md)  
  
# Remarks

Start/end of a SketchEditScope will start/end a transaction group. After a SketchEditScope is started, an application can start transactions and edit the sketch. Individual transactions the application creates inside SketchEditScope will not appear in the undo menu. All transactions committed during the edit mode will be merged into a single one which will bear the given name passed into SketchEditScope constructor. 

# Examples

CopyC#
    
    
    public void ReplaceBoundaryLine(Document document)
    {
       FilteredElementCollector floorCollector = new FilteredElementCollector(document)
          .WhereElementIsNotElementType()
          .OfCategory(BuiltInCategory.OST_Floors).OfClass(typeof(Floor));
    
       Floor floor = floorCollector.FirstOrDefault() as Floor;
       if (floor == null)
       {
          TaskDialog.Show("Error", "Document does not contain a floor.");
          return;
       }
    
       Sketch sketch = document.GetElement(floor.SketchId) as Sketch;
    
       Line line = null;
       foreach (CurveArray curveArray in sketch.Profile)
       {
          foreach (Curve curve in curveArray)
          {
             line = curve as Line;
             if (line != null)
             {
                break;
             }
          }
          if (line != null)
          {
             break;
          }
       }
    
       if (line == null)
       {
          TaskDialog.Show("Error", "Sketch does not contain a straight line.");
          return;
       }
    
       // Start a sketch edit scope
       SketchEditScope sketchEditScope = new SketchEditScope(document, "Replace line with an arc");
       sketchEditScope.Start(sketch.Id);
    
       using (Transaction transaction = new Transaction(document, "Modify sketch"))
       {
          transaction.Start();
    
          // Create arc
          XYZ normal = line.Direction.CrossProduct(XYZ.BasisZ).Normalize().Negate();
          XYZ middle = line.GetEndPoint(0).Add(line.Direction.Multiply(line.Length / 2));
          Curve arc = Arc.Create(line.GetEndPoint(0), line.GetEndPoint(1), middle.Add(normal.Multiply(20)));
    
          // Remove element referenced by the found line. 
          document.Delete(line.Reference.ElementId);
    
          // Model curve creation automatically puts the curve into the sketch, if sketch edit scope is running.
          document.Create.NewModelCurve(arc, sketch.SketchPlane);
    
          transaction.Commit();
       }
    
       sketchEditScope.Commit(new FailuresPreprocessor());
    }

CopyC#
    
    
    public void ReplaceBoundaryLine(Document document)
    {
       FilteredElementCollector floorCollector = new FilteredElementCollector(document)
          .WhereElementIsNotElementType()
          .OfCategory(BuiltInCategory.OST_Floors).OfClass(typeof(Floor));
    
       Floor floor = floorCollector.FirstOrDefault() as Floor;
       if (floor == null)
       {
          TaskDialog.Show("Error", "Document does not contain a floor.");
          return;
       }
    
       Sketch sketch = document.GetElement(floor.SketchId) as Sketch;
    
       Line line = null;
       foreach (CurveArray curveArray in sketch.Profile)
       {
          foreach (Curve curve in curveArray)
          {
             line = curve as Line;
             if (line != null)
             {
                break;
             }
          }
          if (line != null)
          {
             break;
          }
       }
    
       if (line == null)
       {
          TaskDialog.Show("Error", "Sketch does not contain a straight line.");
          return;
       }
    
       // Start a sketch edit scope
       SketchEditScope sketchEditScope = new SketchEditScope(document, "Replace line with an arc");
       sketchEditScope.Start(sketch.Id);
    
       using (Transaction transaction = new Transaction(document, "Modify sketch"))
       {
          transaction.Start();
    
          // Create arc
          XYZ normal = line.Direction.CrossProduct(XYZ.BasisZ).Normalize().Negate();
          XYZ middle = line.GetEndPoint(0).Add(line.Direction.Multiply(line.Length / 2));
          Curve arc = Arc.Create(line.GetEndPoint(0), line.GetEndPoint(1), middle.Add(normal.Multiply(20)));
    
          // Remove element referenced by the found line. 
          document.Delete(line.Reference.ElementId);
    
          // Model curve creation automatically puts the curve into the sketch, if sketch edit scope is running.
          document.Create.NewModelCurve(arc, sketch.SketchPlane);
    
          transaction.Commit();
       }
    
       sketchEditScope.Commit(new FailuresPreprocessor());
    }

# Inheritance Hierarchy

System..::..Object [Autodesk.Revit.DB..::..EditScope](bac11282-3a3b-953e-8bc4-960c62da4946.md) Autodesk.Revit.DB..::..SketchEditScope

# See Also

[SketchEditScope Members](8dec7402-1bdf-526d-b4ed-371700cfb673.md)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)