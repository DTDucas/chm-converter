

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
TransactionGroup..::..Commit Method   
[TransactionGroup Class](f1113d30-4c36-7844-1537-aad7f095cea0.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Commits the transaction group. 

**Namespace:** [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2011 

# Syntax

C#  
---  
      
    
    public [TransactionStatus](29b9a7a8-6754-8310-e063-622b569bb6d5.md) Commit()  
  
Visual Basic  
---  
      
    
    Public Function Commit As [TransactionStatus](29b9a7a8-6754-8310-e063-622b569bb6d5.md)  
  
Visual C++  
---  
      
    
    public:
    [TransactionStatus](29b9a7a8-6754-8310-e063-622b569bb6d5.md) Commit()  
  
#### Return Value

If finished successfully, this method returns TransactionStatus.Committed. 

# Remarks

Committing a group does not change the model. It only confirms the commitment of all inner groups and transactions.

Commit can be called only when all inner transaction groups and transactions are finished, i.e. after they were either committed or rolled back. If there is still a transaction or an inner transaction group open, an attempt to commit this outer group will cause an exception.

# Examples

CopyC#
    
    
    public void GroupedOperations(Autodesk.Revit.DB.Document document)
    {
       // All and any transaction group should be enclosed in a 'using' block or guarded within 
       // a try-catch-finally blocks to guarantee that the group does not out-live its scope.
       using (TransactionGroup transGroup = new TransactionGroup(document, "Level and Grid"))
       {
          if (transGroup.Start() == TransactionStatus.Started)
          {
             // We are going to call two methods, each having its own local transaction.
             // For our compound operation to be considered successful, both the individual
             // transactions must succeed. If either one fails, we will roll our group back,
             // regardless of what transactions might have already been committed.
    
             if (CreateLevel(document, 35.0) && CreateGrid(document, new XYZ(0, 0, 0), new XYZ(0, 10, 0)))
             {
                // The process of committing of a group does not do anything to the already committed
                // transactions. They will stay available on the undo menu and may still be undone
                // individually. If it is not desirable if one transaction from a multi-transaction
                // operation can be undone by th end user, then the transaction group must be
                // assimilated instead of committed. See TransactionGroup.Assimilate for details.
                transGroup.Commit();
             }
             else
             {
                // Since we could not successfully finish at least one of the individual
                // operation, we are going to roll the entire group back, which will
                // undo any transaction already committed while this group was open.
                transGroup.RollBack();
             }
          }
       }
    }

CopyVB.NET
    
    
    Public Sub GroupedOperations(document As Autodesk.Revit.DB.Document)
        ' All and any transaction group should be enclosed in a 'using' block or guarded within 
        ' a try-catch-finally blocks to guarantee that the group does not out-live its scope.
        Using transGroup As New TransactionGroup(document, "Level and Grid")
            If transGroup.Start() = TransactionStatus.Started Then
                ' We are going to call two methods, each having its own local transaction.
                ' For our compound operation to be considered successful, both the individual
                ' transactions must succeed. If either one fails, we will roll our group back,
                ' regardless of what transactions might have already been committed.
    
    
                If CreateLevel(document, 35.0) AndAlso CreateGrid(document, New XYZ(0, 0, 0), New XYZ(0, 10, 0)) Then
                    ' The process of committing of a group does not do anything to the already committed
                    ' transactions. They will stay available on the undo menu and may still be undone
                    ' individually. If it is not desirable if one transaction from a multi-transaction
                    ' operation can be undone by th end user, then the transaction group must be
                    ' assimilated instead of committed. See TransactionGroup.Assimilate for details.
                    transGroup.Commit()
                Else
                    ' Since we could not successfully finish at least one of the individual
                    ' operation, we are going to roll the entire group back, which will
                    ' undo any transaction already committed while this group was open.
                    transGroup.RollBack()
                End If
            End If
        End Using
    End Sub

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..InvalidOperationException](9e715f03-3884-e539-4dd6-8d7545733adc.md) | The Transaction group has not been started (its status is not 'Started').. -or- The transaction's document is currently in failure mode. Transaction groups cannot be closed until failure handling is finished. You may use a transaction finalizer to close a group after the failure handling ends. |
  
# See Also

[TransactionGroup Class](f1113d30-4c36-7844-1537-aad7f095cea0.md)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)