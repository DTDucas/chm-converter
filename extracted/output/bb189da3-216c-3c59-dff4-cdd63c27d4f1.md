

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
ExternalCommandData..::..JournalData Property   
[ExternalCommandData Class](e9aab085-720f-b924-3ace-1f3c33d95d44.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
A data map that can be used to read and write data to the Autodesk Revit journal file.

**Namespace:** [Autodesk.Revit.UI](e86fd90a-8957-02a6-da7f-ced248966e3e.md)**Assembly:** RevitAPIUI (in RevitAPIUI.dll) Version: 24.0.0.0 (24.0.0.0)

# Syntax

C#  
---  
      
    
    public IDictionary<string, string> JournalData { get; set; }  
  
Visual Basic  
---  
      
    
    Public Property JournalData As IDictionary(Of String, String)
    	Get
    	Set  
  
Visual C++  
---  
      
    
    public:
    property IDictionary<String^, String^>^ JournalData {
    	IDictionary<String^, String^>^ get ();
    	void set (IDictionary<String^, String^>^ value);
    }  
  
# Remarks

The data map is a string to string map that can be used to store data in the Revit journal file at the end of execution of the external command. If the command is then executed from the journal file during playback this data is then passed to the external command in this Data property so the external command can execute with this passed data in a UI-less mode, hence providing non interactive journal playback for automated testing purposes. For more information on Revit's journaling features contact the Autodesk Developer Network.

# Examples

CopyC#
    
    
    void WriteJournalData(ExternalCommandData commandData)
    {
        // Get the StringStringMap class which can write data into.
        IDictionary<String, String> dataMap = commandData.JournalData;
        dataMap.Clear();
    
        // Begin to add the support data
        dataMap.Add("Name", "Autodesk.Revit");
        dataMap.Add("Information", "This is an example.");
        dataMap.Add("Greeting", "Hello Everyone.");
    }
    
    /// <summary>
    /// This sample shows how to get data from journal file. 
    /// </summary>
    void ReadJournalData(ExternalCommandData commandData)
    {
        // Get the StringStringMap class which can write data into.
        IDictionary<String, String> dataMap = commandData.JournalData;
    
        // Begin to get the support data.
        String prompt = "Name: " + dataMap["Name"];
        prompt += "\nInformation: " + dataMap["Information"];
        prompt += "\nGreeting: " + dataMap["Greeting"];
    
        TaskDialog.Show("Revit",prompt);
    }

CopyVB.NET
    
    
    Private Sub WriteJournalData(commandData As ExternalCommandData)
        ' Get the StringStringMap class which can write data into.
        Dim dataMap As IDictionary(Of [String], [String]) = commandData.JournalData
        dataMap.Clear()
    
        ' Begin to add the support data
        dataMap.Add("Name", "Autodesk.Revit")
        dataMap.Add("Information", "This is an example.")
        dataMap.Add("Greeting", "Hello Everyone.")
    End Sub
    
    ' <summary>
    ' This sample shows how to get data from journal file. 
    ' </summary>
    Private Sub ReadJournalData(commandData As ExternalCommandData)
        ' Get the StringStringMap class which can write data into.
        Dim dataMap As IDictionary(Of [String], [String]) = commandData.JournalData
    
        ' Begin to get the support data.
        Dim prompt As [String] = "Name: " & dataMap("Name")
        prompt += vbLf & "Information: " & dataMap("Information")
        prompt += vbLf & "Greeting: " & dataMap("Greeting")
    
        TaskDialog.Show("Revit", prompt)
    End Sub

# See Also

[ExternalCommandData Class](e9aab085-720f-b924-3ace-1f3c33d95d44.md)

[Autodesk.Revit.UI Namespace](e86fd90a-8957-02a6-da7f-ced248966e3e.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)