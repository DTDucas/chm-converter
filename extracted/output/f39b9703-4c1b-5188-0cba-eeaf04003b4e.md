

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
LoadCombination..::..GetUsageIds Method   
[LoadCombination Class](82891124-6fb9-e612-ca8c-6f4e32e2c121.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Returns collection of the load combination usage IDs. 

**Namespace:** [Autodesk.Revit.DB.Structure](d586b341-f687-9d90-e96d-255806b7d4fc.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)**Since:** 2016 

# Syntax

C#  
---  
      
    
    public IList<[ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md)> GetUsageIds()  
  
Visual Basic  
---  
      
    
    Public Function GetUsageIds As IList(Of [ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md))  
  
Visual C++  
---  
      
    
    public:
    IList<[ElementId](44f3f7b1-3229-3404-93c9-dc5e70337dd6.md)^>^ GetUsageIds()  
  
#### Return Value

A collection of the load combination usage IDs. 

# Examples

CopyC#
    
    
    void ModifyLoadCombinationLoadCaseLoadUsageLoadNatureAndLoadComponent(Document document, LoadCombination loadCombination)
    {
        // Change name of LoadCombination
        loadCombination.Name = "DL2 + RAIN1";
    
        // Get any LoadCase from combination
        // Combination can have assigned LoadCase or other (nested) LoadCombination so we need to filter out any LoadCombination
        LoadCase case1 = null;
        IList<ElementId> caseAndCombinationIds = loadCombination.GetCaseAndCombinationIds();
        foreach (ElementId id in caseAndCombinationIds)
        {
            Element element = document.GetElement(id);
            if (element is LoadCase)
            {
               case1 = (LoadCase)element;
               break;
            }
            else if (element is LoadCombination)
            {
               continue;
            }
        }
    
        if (case1 == null)
           throw new Exception("Can't get LoadCase.");
    
        // Change case name and number
        case1.Name = "DL2";
        if (LoadCase.IsNumberUnique(document, 3))
        {
            case1.Number = 3;
        }
    
        // Create load nature
        LoadNature liveNature = LoadNature.Create(document, "Dead nature");
        if (liveNature == null)
           throw new Exception("Create new load nature failed.");
    
        // Change nature category, ID and number for case
        case1.SubcategoryId = new ElementId(BuiltInCategory.OST_LoadCasesDead);
        case1.NatureId = liveNature.Id;
    
        //Change factor for case1
        IList<LoadComponent> components = loadCombination.GetComponents();
        foreach (LoadComponent loadComponent in components)
        {
            if (loadComponent.LoadCaseOrCombinationId == case1.Id)
            {
                loadComponent.Factor = 3.0;
            }
        }
    
        loadCombination.SetComponents(components);
    
        // Remove one usage from combination
        IList<ElementId> usages = loadCombination.GetUsageIds();
        usages.RemoveAt(0);
        loadCombination.SetUsageIds(usages);
    
        // Give the user some information
        TaskDialog.Show("Revit", string.Format("Load Combination ID='{0}' modified successfully.", loadCombination.Id.ToString()));
    }

CopyVB.NET
    
    
    Private Sub ModifyLoadCombinationLoadCaseLoadUsageLoadNatureAndLoadComponent(document As Document, loadCombination As LoadCombination)
        ' Change name of LoadCombination
        loadCombination.Name = "DL2 + RAIN1"
    
        ' Get any LoadCase from combination
        ' Combination can have assigned LoadCase or other (nested) LoadCombination so we need to filter out any LoadCombination
        Dim case1 As LoadCase = Nothing
        Dim caseAndCombinationIds As IList(Of ElementId) = loadCombination.GetCaseAndCombinationIds()
        For Each id As ElementId In caseAndCombinationIds
            Dim element As Element = document.GetElement(id)
            If TypeOf element Is LoadCase Then
                case1 = DirectCast(element, LoadCase)
                Exit For
            ElseIf TypeOf element Is LoadCombination Then
                Continue For
            End If
        Next
    
        If case1 Is Nothing Then
            Throw New Exception("Can't get LoadCase.")
        End If
    
        ' Change case name and number
        case1.Name = "DL2"
        If LoadCase.IsNumberUnique(document, 3) Then
            case1.Number = 3
        End If
    
        ' Create load nature
        Dim liveNature As LoadNature = LoadNature.Create(document, "Dead nature")
        If liveNature Is Nothing Then
            Throw New Exception("Create new load nature failed.")
        End If
    
        ' Change nature category, ID and number for case
        case1.SubcategoryId = New ElementId(BuiltInCategory.OST_LoadCasesDead)
        case1.NatureId = liveNature.Id
    
        'Change factor for case1
        Dim components As IList(Of LoadComponent) = loadCombination.GetComponents()
        For Each loadComponent As LoadComponent In components
            If loadComponent.LoadCaseOrCombinationId = case1.Id Then
                loadComponent.Factor = 3.0
            End If
        Next
    
        loadCombination.SetComponents(components)
    
        ' Remove one usage from combination
        Dim usages As IList(Of ElementId) = loadCombination.GetUsageIds()
        usages.RemoveAt(0)
        loadCombination.SetUsageIds(usages)
    
        ' Give the user some information
        TaskDialog.Show("Revit", String.Format("Load Combination ID='{0}' modified successfully.", loadCombination.Id.ToString()))
    End Sub

# See Also

[LoadCombination Class](82891124-6fb9-e612-ca8c-6f4e32e2c121.md)

[Autodesk.Revit.DB.Structure Namespace](d586b341-f687-9d90-e96d-255806b7d4fc.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)