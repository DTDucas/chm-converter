

Collapse AllExpand All Code: All Code: Multiple Code: C# Code: Visual Basic Code: Visual C++   
---  
  
C#Visual BasicVisual C++

Revit 2024 API  
---  
Transaction..::..Commit Method (FailureHandlingOptions)  
[Transaction Class](308ebf8d-d96d-4643-cd1d-34fffcea53fd.md) Example See Also [Send Feedback](javascript:SubmitFeedback\('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\\A%0\\d','Customer%20Feedback'\);)  
---  
  
Commits all changes made to the model during the transaction. 

**Namespace:** [Autodesk.Revit.DB](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)**Assembly:** RevitAPI (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)

# Syntax

C#  
---  
      
    
    public [TransactionStatus](29b9a7a8-6754-8310-e063-622b569bb6d5.md) Commit(
    	[FailureHandlingOptions](c03bb2e5-f679-bf24-4e87-08b3c3a08385.md) options
    )  
  
Visual Basic  
---  
      
    
    Public Function Commit ( _
    	options As [FailureHandlingOptions](c03bb2e5-f679-bf24-4e87-08b3c3a08385.md) _
    ) As [TransactionStatus](29b9a7a8-6754-8310-e063-622b569bb6d5.md)  
  
Visual C++  
---  
      
    
    public:
    [TransactionStatus](29b9a7a8-6754-8310-e063-622b569bb6d5.md) Commit(
    	[FailureHandlingOptions](c03bb2e5-f679-bf24-4e87-08b3c3a08385.md)^ options
    )  
  
#### Parameters

options
    Type: [Autodesk.Revit.DB..::..FailureHandlingOptions](c03bb2e5-f679-bf24-4e87-08b3c3a08385.md) A set of [options](c03bb2e5-f679-bf24-4e87-08b3c3a08385.md) to be used for handling eventual failures during this call. 

The options are only used temporarily during the commitment process. After the transaction is finished, the options will be reset to their default values.

#### Return Value

If finished successfully, this method returns TransactionStatus.Committed 

Note it is possible the RolledBack status is returned instead as an outcome of failure handling. If TransactionStatus.Pending is returned it means that failure handling has not been finalized yet and Revit awaits user's actions. Until committing is fully finalized, no changes to the document can be made (including starting of new transactions).

Be aware that the returned status does not have to be necessarily the same like the status returned by [GetStatus()()()()](fdf98941-eee4-d8af-e3f7-5b6c7ccc3c74.md) even when the method is called immediately after committing the transaction. Such difference may happen due to actions made by a transaction finalizer, if there was one set. (See [FailureHandlingOptions](c03bb2e5-f679-bf24-4e87-08b3c3a08385.md) for more details.)

# Examples

CopyC#
    
    
    // All and any transaction should be enclosed in a 'using'
    // block or guarded within a try-catch-finally blocks
    // to guarantee that a transaction does not out-live its scope.
    using (Transaction transaction = new Transaction(document))
    {
       // Must start the transaction first to be able to modify a document
       transaction.Start("Creating Level");
    
       if (null != Level.Create(document, elevation))
       {
          // If we have a few transactions chained (for whatever reason)
          // we may wish to collect eventual warnings, if any, and show
          // them only when the last transaction of the chain is committed.
          FailureHandlingOptions options = transaction.GetFailureHandlingOptions();
    
          // Now, showing of any eventual mini-warnings will be
          // postponed until the following transaction.
          transaction.Commit(options.SetDelayedMiniWarnings(true));
    
          // Note, after a transaction is committed, the used failure options
          // are lost and replaced with default options again.
       }
    }

CopyVB.NET
    
    
    ' All and any transaction should be enclosed in a 'using'
    ' block or guarded within a try-catch-finally blocks
    ' to guarantee that a transaction does not out-live its scope.
    Using transaction As New Transaction(document)
        ' Must start the transaction first to be able to modify a document
        transaction.Start("Creating Level")
    
    If Level.Create(document, elevation) IsNot Nothing Then
       ' If we have a few transactions chained (for whatever reason)
       ' we may wish to collect eventual warnings, if any, and show
       ' them only when the last transaction of the chain is committed.
       Dim options As FailureHandlingOptions = transaction.GetFailureHandlingOptions()
    
       ' Now, showing of any eventual mini-warnings will be
       ' postponed until the following transaction.
    
    
       ' Note, after a transaction is committed, the used failure options
       ' are lost and replaced with default options again.
       transaction.Commit(options.SetDelayedMiniWarnings(True))
    End If
    End Using

# Exceptions

| Exception | Condition |
| --- | --- |
| [Autodesk.Revit.Exceptions..::..ArgumentNullException](631e1424-60f4-929b-4e52-dda9dcd26316.md) | A non-optional argument was null |
| [Autodesk.Revit.Exceptions..::..InvalidOperationException](9e715f03-3884-e539-4dd6-8d7545733adc.md) | The current status of the transaction is not 'Started'. Transaction must be started before calling Commit or Rollback. -or- The transaction's document is currently in failure mode. No transaction operations are permitted until failure handling is finished. |
  
# See Also

[Transaction Class](308ebf8d-d96d-4643-cd1d-34fffcea53fd.md)

[Commit Overload](bb7917ec-9fc7-b0a8-e3b7-2b38015cbc08.md)

[Autodesk.Revit.DB Namespace](87546ba7-461b-c646-cbb1-2cb8f5bff8b2.md)

Send comments on this topic to [Autodesk](mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API)